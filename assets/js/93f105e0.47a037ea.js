"use strict";(self.webpackChunkwjftu_ds=self.webpackChunkwjftu_ds||[]).push([[2086],{4763:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"tool/kafka","title":"Kafka","description":"Linkedin \u5f00\u6e90\u7684\u6d88\u606f\u961f\u5217\uff0c\u591a\u96c6\u7fa4\uff0c\u53ef\u6269\u5c55","source":"@site/note/tool/kafka.md","sourceDirName":"tool","slug":"/tool/kafka","permalink":"/note/tool/kafka","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":31,"frontMatter":{"title":"Kafka","sidebar_position":31},"sidebar":"tutorialSidebar","previous":{"title":"Oracle","permalink":"/note/tool/oracle"},"next":{"title":"Mongo DB","permalink":"/note/tool/mongo"}}');var t=n(4848),a=n(8453);const i={title:"Kafka",sidebar_position:31},s="kafka",c={},l=[{value:"\u5feb\u901f\u4e0a\u624b",id:"\u5feb\u901f\u4e0a\u624b",level:3},{value:"\u6982\u5ff5",id:"\u6982\u5ff5",level:3},{value:"Java \u5ba2\u6237\u7aef\u7684\u7b80\u5355\u4f7f\u7528",id:"java-\u5ba2\u6237\u7aef\u7684\u7b80\u5355\u4f7f\u7528",level:3},{value:"\u96c6\u7fa4",id:"\u96c6\u7fa4",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3}];function d(e){const r={a:"a",br:"br",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"kafka",children:"kafka"})}),"\n",(0,t.jsx)(r.p,{children:"Linkedin \u5f00\u6e90\u7684\u6d88\u606f\u961f\u5217\uff0c\u591a\u96c6\u7fa4\uff0c\u53ef\u6269\u5c55"}),"\n",(0,t.jsxs)(r.p,{children:["\u5b98\u7f51 ",(0,t.jsx)(r.a,{href:"https://kafka.apache.org/",children:"https://kafka.apache.org/"})]}),"\n",(0,t.jsxs)(r.p,{children:["\u4e0b\u8f7d\u5730\u5740\uff1a",(0,t.jsx)(r.a,{href:"https://kafka.apache.org/downloads",children:"https://kafka.apache.org/downloads"})]}),"\n",(0,t.jsx)(r.h3,{id:"\u5feb\u901f\u4e0a\u624b",children:"\u5feb\u901f\u4e0a\u624b"}),"\n",(0,t.jsx)(r.p,{children:"\u53ef\u76f4\u63a5\u4e0b\u8f7d\u4e8c\u8fdb\u5236\u6587\u4ef6\u8fd0\u884c\u3002\u5f53\u524d\u6700\u65b0\u7248\u4e3a kafka_2.12-3.7.0.tgz \u548c kafka_2.13-3.7.0.tgz \u3002\u524d\u9762\u7684 2.13 \u662f Scala \u7684\u7248\u672c\u53f7\u3002kafka \u7528\u4e0d\u540c\u7248\u672c\u7684 Scala \u6784\u5efa\uff0c\u53ea\u6709\u5728\u60f3\u7528 scala \u4e14\u5e0c\u671b\u4e0e kafka \u7528\u76f8\u540c\u7248\u672c\u7684 scala \u624d\u9700\u8981\u5173\u6ce8\u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u89e3\u538b\u7f29"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"$ tar -xzf kafka_2.13-3.7.0.tgz\n$ cd kafka_2.13-3.7.0\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u542f\u52a8 kafka \u3002\u5148\u542f\u52a8 zookeeper\uff0c\u518d\u542f\u52a8 kafka server"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# Start the ZooKeeper service\n$ bin/zookeeper-server-start.sh config/zookeeper.properties\n\n\n# Start the Kafka broker service\n$ bin/kafka-server-start.sh config/server.properties\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u4f7f\u7528 jps \u547d\u4ee4\u53ef\u4ee5\u770b\u5230 java \u8fdb\u7a0b"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:" % jps\n2001 Jps\n1623 Kafka\n1230 QuorumPeerMain\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u521b\u5efa topic\uff0c\u540d\u5b57\u4e3a quickstart-events"}),"\n",(0,t.jsxs)(r.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(r.code,{children:"--list"})," \u53ef\u4ee5\u67e5\u770b\u6240\u6709 topic\uff0c\u4f7f\u7528 ",(0,t.jsx)(r.code,{children:"--describe"})," \u53ef\u4ee5\u63cf\u8ff0 topic"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"mac@MacdeMac-mini kafka_2.13-3.6.1 % bin/kafka-topics.sh --create --topic quickstart-events --bootstrap-server localhost:9092\nCreated topic quickstart-events.\nmac@MacdeMac-mini kafka_2.13-3.6.1 % bin/kafka-topics.sh --list --bootstrap-server localhost:9092\nquickstart-events\nmac@MacdeMac-mini kafka_2.13-3.6.1 % bin/kafka-topics.sh --describe --topic quickstart-events --bootstrap-server localhost:9092\nTopic: quickstart-events\tTopicId: dYnjTlTpTqOCUSE4lLFO2g\tPartitionCount: 1\tReplicationFactor: 1\tConfigs: \n\tTopic: quickstart-events\tPartition: 0\tLeader: 0\tReplicas: 0\tIsr: 0\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u8fd0\u884c producer \u5ba2\u6237\u7aef\u7ed9 topic \u521b\u5efa event\u3002\u6bcf\u4e00\u884c\u662f\u4e00\u4e2a event"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"% bin/kafka-console-producer.sh --topic quickstart-events --bootstrap-server localhost:9092\n>This is my first event\n>This is my second event\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u8fd0\u884c consumer \u5ba2\u6237\u7aef\u6d88\u8d39 event"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"% bin/kafka-console-consumer.sh --topic quickstart-events --from-beginning --bootstrap-server localhost:9092\nThis is my first event\nThis is my second event\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u5220\u9664 topic"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"bin/kafka-topics.sh --bootstrap-server localhost:9092 --delete --topic quickstart-events\n"})}),"\n",(0,t.jsx)(r.h3,{id:"\u6982\u5ff5",children:"\u6982\u5ff5"}),"\n",(0,t.jsxs)(r.p,{children:["Producer",(0,t.jsx)(r.br,{}),"\n","\u5bf9\u63a5\u5916\u90e8\uff0c\u751f\u4ea7\u6570\u636e"]}),"\n",(0,t.jsxs)(r.p,{children:["Consumer",(0,t.jsx)(r.br,{}),"\n","\u6d88\u8d39\u6570\u636e"]}),"\n",(0,t.jsxs)(r.p,{children:["Topic",(0,t.jsx)(r.br,{}),"\n","\u6d88\u606f\u901a\u8fc7 Topic \u5206\u7c7b"]}),"\n",(0,t.jsxs)(r.p,{children:["Partition",(0,t.jsx)(r.br,{}),"\n","\u4e00\u4e2a Topic \u53ef\u4ee5\u5bf9\u5e94\u591a\u4e2a Partition \u3002\u4e00\u4e2a Partition \u7684\u6570\u636e\u53ea\u80fd\u7531\u4e00\u4e2a Consumer \u6d88\u8d39"]}),"\n",(0,t.jsxs)(r.p,{children:["Broker",(0,t.jsx)(r.br,{}),"\n","\u6bcf\u4e2a\u72ec\u7acb\u7684\u670d\u52a1\u5668\u662f\u4e00\u4e2a broker \uff0c\u6bcf\u4e2a partition \u4ece\u5c5e\u4e8e\u4e00\u4e2a broker \uff0c\u4f46\u53ef\u4ee5\u5206\u914d\u7ed9\u591a\u4e2a broker \u53d1\u751f\u5206\u533a\u590d\u5236\u63d0\u4f9b\u6d88\u606f\u5197\u4f59"]}),"\n",(0,t.jsx)(r.h3,{id:"java-\u5ba2\u6237\u7aef\u7684\u7b80\u5355\u4f7f\u7528",children:"Java \u5ba2\u6237\u7aef\u7684\u7b80\u5355\u4f7f\u7528"}),"\n",(0,t.jsx)(r.p,{children:"\u751f\u4ea7\u8005\uff1a"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'// \u914d\u7f6e\u751f\u4ea7\u8005\u5bf9\u8c61\nMap<String, Object> configMap = new HashMap<String, Object>();\nconfigMap.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");\nconfigMap.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");\nconfigMap.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");\n\n// \u6839\u636e\u914d\u7f6e\u521b\u5efa\u751f\u4ea7\u8005\u5bf9\u8c61\nKafkaProducer<String, String> producer = new KafkaProducer<>(configMap);\n\n// \u53d1\u9001\u6570\u636e\nProducerRecord<String,String> record1 = new ProducerRecord<>("topic1", "key1", "value1");\nProducerRecord<String,String> record2 = new ProducerRecord<>("topic1", "key2", "value2");\nproducer.send(record1);\nproducer.send(record2);\n\n// \u5173\u95ed\u751f\u4ea7\u8005\u5bf9\u8c61\nproducer.close();\n'})}),"\n",(0,t.jsx)(r.p,{children:"\u6d88\u8d39\u8005\uff1a"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'// \u6d88\u8d39\u8005\u5bf9\u8c61\u914d\u7f6e\nMap<String, Object> configMap = new HashMap<>();\nconfigMap.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");\nconfigMap.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());\nconfigMap.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());\nconfigMap.put(ConsumerConfig.GROUP_ID_CONFIG, "group1");\n//        configMap.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");\n// \u521b\u5efa\u6d88\u8d39\u8005\u5bf9\u8c61\nKafkaConsumer<String, String> consumer = new KafkaConsumer<>(configMap);\n// \u8ba2\u9605 topic\nconsumer.subscribe(Collections.singletonList("topic1"));\n\n// \u62c9\u53d6\u6570\u636e\uff08\u8d85\u65f6\u65f6\u95f4\u592a\u77ed\u53ef\u80fd\u4f1a\u5f97\u5230 0 \u6761\u6570\u636e\uff09\nConsumerRecords<String, String> records = consumer.poll(2000);\n\n\nSystem.out.println(records.count());\nfor(ConsumerRecord record : records) {\n\tSystem.out.println(record);\n}\n/* \n\u8f93\u51fa\uff1a\n2\nConsumerRecord(topic = topic1, partition = 0, leaderEpoch = 0, offset = 2, CreateTime = 1723463707470, serialized key size = 4, serialized value size = 6, headers = RecordHeaders(headers = [], isReadOnly = false), key = key1, value = value1)\nConsumerRecord(topic = topic1, partition = 0, leaderEpoch = 0, offset = 3, CreateTime = 1723463707484, serialized key size = 4, serialized value size = 6, headers = RecordHeaders(headers = [], isReadOnly = false), key = key2, value = value2)\n*/\n\n// \u5173\u95ed\u6d88\u8d39\u8005\u5bf9\u8c61\nconsumer.close();\n'})}),"\n",(0,t.jsx)(r.h3,{id:"\u96c6\u7fa4",children:"\u96c6\u7fa4"}),"\n",(0,t.jsx)(r.p,{children:"\u914d\u7f6e zookeeper.properties"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# the directory where the snapshot is stored.\ndataDir=/tmp/cluster/zookeeper\n# the port at which the clients will connect\nclientPort=2182\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u914d\u7f6e 3 \u4e2a broker \u7684 server.properties"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# broker1\n# The id of the broker. This must be set to a unique integer for each broker.\nbroker.id=1\nzookeeper.connect=localhost:2182\n\n# The address the socket server listens on. If not configured, the host name will be equal to the value of\n# java.net.InetAddress.getCanonicalHostName(), with PLAINTEXT listener name, and port 9092.\n#   FORMAT:\n#     listeners = listener_name://host_name:port\n#   EXAMPLE:\n#     listeners = PLAINTEXT://your.host.name:9092\nlisteners=PLAINTEXT://:9091\n\n# A comma separated list of directories under which to store log files\nlog.dirs=/tmp/cluster/broker1\n\n# broker2\nbroker.id=1\nlisteners=PLAINTEXT://:9091\nlog.dirs=/tmp/cluster/broker3/data\nzookeeper.connect=localhost:2182\n\n# broker3\nbroker.id=1\nlisteners=PLAINTEXT://:9091\nlog.dirs=/tmp/cluster/broker3/data\nzookeeper.connect=localhost:2182\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u4f9d\u6b21\u542f\u52a8 zookeeper \u548c 3 \u4e2a kafka broker"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# \u542f\u52a8 kafka1\n# kafka1 \u65e5\u5fd7\n[2024-08-20 21:02:52,658] INFO Kafka startTimeMs: 1724158972653 (org.apache.kafka.common.utils.AppInfoParser)\n[2024-08-20 21:02:52,659] INFO [KafkaServer id=1] started (kafka.server.KafkaServer)\n[2024-08-20 21:02:52,763] INFO [zk-broker-1-to-controller-alter-partition-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n[2024-08-20 21:02:52,789] INFO [zk-broker-1-to-controller-forwarding-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n\n# \u542f\u52a8 kafka2\n# kafka1 \u65e5\u5fd7\n[2024-08-20 21:03:43,830] INFO [Controller id=1, targetBrokerId=2] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:03:43,831] WARN [Controller id=1, targetBrokerId=2] Connection to node 2 (localhost/127.0.0.1:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:03:43,831] INFO [Controller id=1, targetBrokerId=2] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:03:43,934] INFO [Controller id=1, targetBrokerId=2] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:03:43,934] WARN [Controller id=1, targetBrokerId=2] Connection to node 2 (localhost/127.0.0.1:9092) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:03:43,934] INFO [Controller id=1, targetBrokerId=2] Client requested connection close from node 2 (org.apache.kafka.clients.NetworkClient)\n# kafka2 \u65e5\u5fd7\n[2024-08-20 21:03:43,985] INFO [KafkaServer id=2] started (kafka.server.KafkaServer)\n[2024-08-20 21:03:44,120] INFO [zk-broker-2-to-controller-alter-partition-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n[2024-08-20 21:03:44,167] INFO [zk-broker-2-to-controller-forwarding-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n\n# \u542f\u52a8 kafka3\n# kafka1 \u65e5\u5fd7\n[2024-08-20 21:04:48,061] INFO [Controller id=1, targetBrokerId=3] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:04:48,062] WARN [Controller id=1, targetBrokerId=3] Connection to node 3 (localhost/127.0.0.1:9093) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:04:48,062] INFO [Controller id=1, targetBrokerId=3] Client requested connection close from node 3 (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:04:48,164] INFO [Controller id=1, targetBrokerId=3] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:04:48,164] WARN [Controller id=1, targetBrokerId=3] Connection to node 3 (localhost/127.0.0.1:9093) could not be established. Broker may not be available. (org.apache.kafka.clients.NetworkClient)\n[2024-08-20 21:04:48,164] INFO [Controller id=1, targetBrokerId=3] Client requested connection close from node 3 (org.apache.kafka.clients.NetworkClient)\n# kafka3 \u65e5\u5fd7\n[2024-08-20 21:04:48,220] INFO [KafkaServer id=3] started (kafka.server.KafkaServer)\n[2024-08-20 21:04:48,373] INFO [zk-broker-3-to-controller-alter-partition-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n[2024-08-20 21:04:48,391] INFO [zk-broker-3-to-controller-forwarding-channel-manager]: Recorded new controller, from now on will use node localhost:9091 (id: 1 rack: null) (kafka.server.BrokerToControllerRequestThread)\n"})}),"\n",(0,t.jsxs)(r.p,{children:["zookeeper \u7684 /brokers/ids \u4e0b\u6709 id ",(0,t.jsx)(r.code,{children:"1\uff0c2\uff0c3"}),"\uff0c zookeeper \u7684 /controler \u663e\u793a"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-json",children:'{"version":2,"brokerid":1,"timestamp":"1724158972518","kraftControllerEpoch":-1}\n'})}),"\n",(0,t.jsx)(r.p,{children:"kafka 3.8 \u7248\u672c\u4ee5\u540e\u53ef\u4ee5\u4e0d\u9700\u8981 zookeeper\uff0c\u901a\u8fc7 kraft \u7b97\u6cd5\u4ee3\u66ff\u3002"}),"\n",(0,t.jsx)(r.p,{children:"Zookeeper \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u7684\uff0c\u4e3a\u5206\u5e03\u5f0f\u6846\u67b6\u63d0\u4f9b\u534f\u8c03\u670d\u52a1\u7684Apache\u9879\u76ee\u3002"}),"\n",(0,t.jsx)(r.p,{children:"ZooKeeper \u6570\u636e\u6a21\u578b\u7684\u7ed3\u6784\u7c7b\u4f3c Linux \u6587\u4ef6\u7cfb\u7edf\uff0c\u6bcf\u4e2a zNode \u8282\u70b9\u901a\u8fc7\u5176\u8def\u5f84\u552f\u4e00\u6807\u8bc6\u3002"}),"\n",(0,t.jsx)(r.p,{children:"kafka broker \u4f1a\u6ce8\u518c\u5230 zookeeper \u4e0a\uff0c\u6bcf\u4e2a broker \u4f1a\u6709\u5168\u5c40\u552f\u4e00 id\uff0c\u4f1a\u628a ip \u548c\u7aef\u53e3\u6ce8\u518c\u5230 zookeeper \u4e2d\u3002kafka \u8fde\u63a5\u4e0a zookepper \u540e\u4f1a\u5728 zookepper \u4e0a\u521b\u5efa ZNode\uff0c\u6709\u6301\u4e45\u5316\u7684\u4e5f\u6709\u4e34\u65f6\u7684\uff0c\u4e34\u65f6\u7684\u5728\u8fde\u63a5\u65ad\u5f00\u4f1a\u5220\u9664\u3002"}),"\n",(0,t.jsx)(r.p,{children:"broker \u6ce8\u518c\u5230 zookeeper \u4e0a\u4f1a\u9009\u4e3e\u7ba1\u7406\u8005 controller \uff0ccontroller \u5982\u679c down \u4e86\u4f1a\u91cd\u65b0\u9009\u4e3e"}),"\n",(0,t.jsx)(r.p,{children:"\u7b2c\u4e00\u4e2a broker \u542f\u52a8\uff0c\u4f1a\u5728 /brokers/ids \u4e0b\u6ce8\u518c\uff0c\u7136\u540e\u76d1\u542c /controller \uff0c\u7136\u540e\u6ce8\u518c /controller \u8282\u70b9\uff0c\u9009\u4e3e\u6210\u4e3a controller\u3002\u7b2c\u4e8c\u4e2a broker \u542f\u52a8\uff0c\u4f1a\u5728 /brokers/ids \u4e0b\u6ce8\u518c\uff0c\u7136\u540e\u76d1\u542c /controller \uff0c\u7136\u540e\u6ce8\u518c /controller \u8282\u70b9\uff0c\u7136\u540e\u4f1a\u901a\u77e5 broker1 \u96c6\u7fa4\u7684\u53d8\u5316\uff0cbroker1 \u4f1a\u8fde\u63a5\u6240\u6709\u7684 broker \u5e76\u53d1\u9001\u96c6\u7fa4\u76f8\u5173\u6570\u636e\u3002controller \u5982\u679c down \u4e86\uff0c\u76d1\u542c /controller \u7684 broker \u4f1a\u6536\u5230\u901a\u77e5"}),"\n",(0,t.jsx)(r.h3,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,t.jsx)(r.p,{children:"\u521b\u5efa topic"}),"\n",(0,t.jsxs)(r.p,{children:["\u76f4\u63a5\u5411 kafka \u4e0d\u5b58\u5728\u7684 topic \u53d1\u9001\u6d88\u606f\uff0c\u4f1a\u53d1\u9001\u6210\u529f\uff0c\u5e76\u81ea\u52a8\u521b\u5efa\u4e3b\u9898\uff0c\u5982\u679c\u4e0d\u9700\u8981\uff0c\u53ef\u4ee5\u914d\u7f6e ",(0,t.jsx)(r.code,{children:"auto.create.topics.enable=false"})," \u3002\u901a\u5e38\u4e0d\u4f1a\u7528\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u4e3b\u9898\uff0c\u800c\u662f\u624b\u52a8\u521b\u5efa\u3002\u624b\u52a8\u521b\u5efa\u53ef\u4ee5\u6307\u5b9a\u5206\u533a\u6570\u548c\u526f\u672c\u6570\u3002"]}),"\n",(0,t.jsx)(r.p,{children:"NewTopic \u5bf9\u8c61\u521b\u5efa\u7684\u65f6\u5019\u4f20\u5165 3 \u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f\uff0ctopic \u540d\u79f0\uff0c\u5206\u533a\u6570\u91cf\uff0c\u526f\u672c\u56e0\u5b50\u3002\u8fd9\u91cc admin \u53ea\u914d\u7f6e\u4e86 9092 \uff0c\u5b83\u53ef\u4ee5\u4ece 9092 \u4e2d\u62ff\u5230\u96c6\u7fa4\u4fe1\u606f\uff0c\u5e76\u5728\u5404\u4e2a broker \u4e2d\u521b\u5efa partition \u548c node"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'HashMap<String,Object> configMap = new HashMap<>();\nconfigMap.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");\n\nAdmin admin = Admin.create(configMap);\n\nNewTopic topic1 = new NewTopic("topic1", 1, (short) 1);\nNewTopic topic2 = new NewTopic("topic1", 2, (short) 2);\nadmin.createTopics(Arrays.asList(topic1, topic2));\n'})}),"\n",(0,t.jsx)(r.p,{children:"\u521b\u5efa\u5b8c\u6210\u540e\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u6587\u4ef6\u5939"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"/tmp/cluster/broker1/data/topic1-0\n/tmp/cluster/broker1/data/topic2-0\n/tmp/cluster/broker2/data/topic2-0\n/tmp/cluster/broker2/data/topic2-1\n/tmp/cluster/broker3/data/topic2-1\n"})}),"\n",(0,t.jsx)(r.p,{children:"\u901a\u8fc7\u53ef\u89c6\u5316\u5de5\u5177 Kafdrop \u53ef\u4ee5\u770b\u5230 topic1 \u53ea\u6709\u4e00\u4e2a partition0 \uff0cleader node \u548c replica node \u53ea\u6709\u4e00\u4e2a 1\u3002 topic2 \u7684 partition0 \u7684 leader node \u662f 1\uff0creplica node \u662f 1,2\uff0cpartition1 \u7684 leader node \u662f 2\uff0creplica node \u662f 2,3"}),"\n",(0,t.jsx)(r.p,{children:"kafka \u4f1a\u5c3d\u53ef\u80fd\u5747\u5300\u5206\u5e03 leader node \uff0c\u4ee5\u9632\u6b62\u70ed\u70b9\u95ee\u9898"}),"\n",(0,t.jsx)(r.p,{children:"\u4e5f\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u5206\u533a\u548c\u526f\u672c"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'HashMap<Integer, List<Integer>> partitionMap = new HashMap<>();\n// partition0 \u5728 2,3 \uff0cpartition1 \u5728 3,1 \uff0c\u6bcf\u4e2a partition \u7684\u7b2c\u4e00\u4e2a\u4e3a leadder\npartitionMap.put(0, Arrays.asList(2,3));\npartitionMap.put(1, Arrays.asList(3,1));\nNewTopic topic3 = new NewTopic("topic3", partitionMap);\n\nadmin.createTopics(Arrays.asList(topic3));\n'})})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>s});var o=n(6540);const t={},a=o.createContext(t);function i(e){const r=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(a.Provider,{value:r},e.children)}}}]);