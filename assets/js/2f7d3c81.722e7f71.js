"use strict";(self.webpackChunkwjftu_ds=self.webpackChunkwjftu_ds||[]).push([[9945],{5309:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"springboot/web/handle-exception","title":"\u5168\u5c40\u5f02\u5e38\u5904\u7406","description":"\u53ef\u4ee5\u4f7f\u7528 @ControllerAdvice \u6216 @RestControllerAdvice \u5904\u7406\u5168\u5c40\u5f02\u5e38\uff0c\u4ee5\u514d\u628a\u4e0d\u5fc5\u8981\u7684\u62a5\u9519\u4fe1\u606f\u66b4\u9732\u7ed9\u8c03\u7528\u65b9\u3002","source":"@site/note/springboot/web/handle-exception.md","sourceDirName":"springboot/web","slug":"/springboot/web/handle-exception","permalink":"/note/springboot/web/handle-exception","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"WEB \u5e94\u7528","permalink":"/note/springboot/web/"},"next":{"title":"Spring Boot Security","permalink":"/note/springboot/web/security"}}');var s=t(4848),o=t(8453);const a={},i="\u5168\u5c40\u5f02\u5e38\u5904\u7406",l={},c=[];function d(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u5168\u5c40\u5f02\u5e38\u5904\u7406",children:"\u5168\u5c40\u5f02\u5e38\u5904\u7406"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"@ControllerAdvice"})," \u6216 ",(0,s.jsx)(n.code,{children:"@RestControllerAdvice"})," \u5904\u7406\u5168\u5c40\u5f02\u5e38\uff0c\u4ee5\u514d\u628a\u4e0d\u5fc5\u8981\u7684\u62a5\u9519\u4fe1\u606f\u66b4\u9732\u7ed9\u8c03\u7528\u65b9\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@ControllerAdvice"})," \u53ef\u4ee5\u6309\u6ce8\u89e3\uff0c\u6216\u5305\u540d\uff0c\u6216\u7c7b\u540d\u6765\u5904\u7406\u5f02\u5e38\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@ControllerAdvice(annotations = RestController.class)\n@ControllerAdvice("com.wjftu.controller")\n@ControllerAdvice(assignableTypes={MyController.class, MyAbstractController.class})\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"@ExceptionHandler"})," \u8868\u793a\u5904\u7406\u6307\u5b9a\u5730\u65b9\u5f02\u5e38\uff0c\u540c\u65f6\u5b58\u5728\u7236\u7c7b\u548c\u5b50\u7c7b\u65f6\u5b50\u7c7b\u5f02\u5e38\u4f18\u5148\u3002",(0,s.jsx)(n.code,{children:"@ResponseStatus"})," \u6307\u5b9a\u8fd4\u56de\u72b6\u6001\u7801"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)\n@ExceptionHandler(IndexOutOfBoundsException.class)\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4f8b\u5b50\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u5b9a\u4e49\u4e00\u4e2a\u8fd4\u56de\u7ed3\u679c\u7c7b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class ResponseEntity<T> {\n\n    Integer code;\n    String message;\n    T data;\n\n    public ResponseEntity(Integer code, String message){\n        this.code=code;\n        this.message=message;\n    }\n\n    public static ResponseEntity success(){\n        return new ResponseEntity(200, "success");\n    }\n\n    public static <T> ResponseEntity<T> success(T data){\n        return new ResponseEntity(200, "success", data);\n    }\n\n    public static ResponseEntity error(Integer code, String message){\n        return new ResponseEntity(code, message);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5b9a\u4e49\u4e24\u4e2a Controller"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@RestController\n@RequestMapping("v2")\npublic class ExceptionHandleController {\n\n    @RequestMapping("divide/{a}/{b}")\n    public ResponseEntity<Integer> divide(@PathVariable("a") int a, @PathVariable("b") int b){\n        int ret = a / b;\n        return ResponseEntity.success(ret);\n    }\n\n    int[] arr={3,1,4,1,5};\n    @RequestMapping("number")\n    public ResponseEntity<Integer> getNumber(@RequestParam Integer i){\n        return ResponseEntity.success(arr[i]);\n    }\n}\n\n\n\n@RestController\n@RequestMapping("v1")\npublic class NormalController {\n\n    @RequestMapping("divide/{a}/{b}")\n    public ResponseEntity<Integer> divide(@PathVariable("a") int a, @PathVariable("b") int b){\n        int ret = a / b;\n        return ResponseEntity.success(ret);\n    }\n\n    int[] arr={3,1,4,1,5};\n    @RequestMapping("number")\n    public ResponseEntity<Integer> getNumber(@RequestParam Integer i){\n        return ResponseEntity.success(arr[i]);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u5904\u7406\u5f02\u5e38\uff0c\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"@RestControllerAdvice"})," \u6ce8\u89e3"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@RestControllerAdvice(assignableTypes = {ExceptionHandleController.class})\n@Slf4j\npublic class GlobalExceptionHandler {\n\n    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)\n    @ExceptionHandler(ArithmeticException.class)\n    public ResponseEntity handleByZero(){\n        return ResponseEntity.error(500, "can not divide by 0");\n    }\n\n    @ExceptionHandler(IndexOutOfBoundsException.class)\n    public ResponseEntity handleIndexOutOfBound(IndexOutOfBoundsException e){\n        log.error(e.getMessage());\n        return ResponseEntity.error(600,"index out of bound: "+e.getMessage());\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u6bd4\u8f83\u4e24\u8005\u5dee\u5f02"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'//http://127.0.0.1:8080/v1/divide/1/0\n{\n    "timestamp": "2022-05-16T15:38:47.504+00:00",\n    "status": 500,\n    "error": "Internal Server Error",\n    "trace": "java.lang.ArithmeticException: / by zero\\n\\tat exception.handler.controller.NormalController.divide(NormalController.java:13)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\\n...",\n    "message": "/ by zero",\n    "path": "/v1/divide/1/0"\n}\n\n//http://127.0.0.1:8080/v2/divide/1/0\n{\n    "code": 500,\n    "message": "can not divide by 0",\n    "data": null\n}\n\n//http://127.0.0.1:8080/v1/number?i=9\n{\n    "timestamp": "2022-05-16T15:37:46.632+00:00",\n    "status": 500,\n    "error": "Internal Server Error",\n    "trace": "java.lang.ArrayIndexOutOfBoundsException: Index 9 out of bounds for length 5\\n\\tat exception.handler.controller.NormalController.getNumber(NormalController.java:20)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\\n\\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\\n\\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n...",\n    "message": "Index 9 out of bounds for length 5",\n    "path": "/v1/number"\n}\n\n//http://127.0.0.1:8080/v2/number?i=9\n{\n    "code": 600,\n    "message": "index out of bound: Index 9 out of bounds for length 5",\n    "data": null\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);