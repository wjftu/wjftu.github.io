<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://wjftu.com/blog</id>
    <title>健峰的网站 Blog</title>
    <updated>2024-03-18T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://wjftu.com/blog"/>
    <subtitle>健峰的网站 Blog</subtitle>
    <icon>https://wjftu.com/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[自建网盘 Seafile 和 Cloudreve]]></title>
        <id>https://wjftu.com/blog/clouddrive</id>
        <link href="https://wjftu.com/blog/clouddrive"/>
        <updated>2024-03-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[需要自建网盘，搜索了一下，有很多成熟的产品 Seafile Cloudreve NextCloud filerun 等等。以前只用过玩具级别的 Tiny File Manager ，这次试一下部署成熟的产品。]]></summary>
        <content type="html"><![CDATA[<p>需要自建网盘，搜索了一下，有很多成熟的产品 Seafile Cloudreve NextCloud filerun 等等。以前只用过玩具级别的 Tiny File Manager ，这次试一下部署成熟的产品。</p>
<p>Seafile 和 Cloudreve 口碑比较好，尝试用 docker-compose 部署体验一下。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="seafile">Seafile<a href="https://wjftu.com/blog/clouddrive#seafile" class="hash-link" aria-label="Direct link to Seafile" title="Direct link to Seafile">​</a></h3>
<p>同类产品： Cloudreve Nextcloud</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mariadb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">10.11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MYSQL_ROOT_PASSWORD=123456  </span><span class="token comment" style="color:#999988;font-style:italic"># Requested, set the root's password of MySQL service.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MYSQL_LOG_CONSOLE=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MARIADB_AUTO_UPGRADE=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /opt/seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">mysql/db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/var/lib/mysql  </span><span class="token comment" style="color:#999988;font-style:italic"># Requested, specifies the path to MySQL data persistent store.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">memcached</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> memcached</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.6.18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">memcached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">entrypoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> memcached </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">m 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">seafile</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> seafileltd/seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">mc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> seafile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"8001:80"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#     - "443:443"  # If https is enabled, cancel the comment.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> /opt/seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/shared   </span><span class="token comment" style="color:#999988;font-style:italic"># Requested, specifies the path to Seafile data persistent store.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DB_HOST=db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DB_ROOT_PASSWD=123456  </span><span class="token comment" style="color:#999988;font-style:italic"># Requested, the value should be root's password of MySQL service.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> TIME_ZONE=Etc/UTC  </span><span class="token comment" style="color:#999988;font-style:italic"># Optional, default is UTC. Should be uncomment and set to your local time zone.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> SEAFILE_ADMIN_EMAIL=a@abc.com </span><span class="token comment" style="color:#999988;font-style:italic"># Specifies Seafile admin user, default is 'me@example.com'.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> SEAFILE_ADMIN_PASSWORD=123123     </span><span class="token comment" style="color:#999988;font-style:italic"># Specifies Seafile admin password, default is 'asecret'.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> SEAFILE_SERVER_LETSENCRYPT=false   </span><span class="token comment" style="color:#999988;font-style:italic"># Whether to use https or not.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> memcached</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  seafile</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">:</span><br></span></code></pre></div></div>
<p>上面的配置文件设置了 8001 端口。MYSQL_ROOT_PASSWORD 和 DB_ROOT_PASSWD 要一致。SEAFILE_ADMIN_EMAIL SEAFILE_ADMIN_PASSWORD 是管理员账号和密码。</p>
<p>启动：</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up -d</span><br></span></code></pre></div></div>
<p>访问 <a href="http://ip:8001/" target="_blank" rel="noopener noreferrer">http://ip:8001</a> 即可看到登录页面，使用配置的用户名可以登录</p>
<p>配置 caddy 反向代理 seafile ，这样就可以通过 https 和域名访问了</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"apps"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"http"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">"http_port"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">"https_port"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">"servers"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token property" style="color:#36acaa">"srv0"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token property" style="color:#36acaa">"listen"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token string" style="color:#e3116c">":443"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token property" style="color:#36acaa">"routes"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token property" style="color:#36acaa">"match"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token property" style="color:#36acaa">"host"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><span class="token string" style="color:#e3116c">"abc.com"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token property" style="color:#36acaa">"handle"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token property" style="color:#36acaa">"handler"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"subroute"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token property" style="color:#36acaa">"routes"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          </span><span class="token property" style="color:#36acaa">"handle"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                              </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token property" style="color:#36acaa">"handler"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"reverse_proxy"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token property" style="color:#36acaa">"headers"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                      </span><span class="token property" style="color:#36acaa">"request"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                          </span><span class="token property" style="color:#36acaa">"set"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"Accept-Encoding"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"identity"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"Host"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"{http.reverse_proxy.upstream.hostport}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"X-Forwarded-For"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"{http.request.remote.host}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"X-Forwarded-Port"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"{http.request.port}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"X-Forwarded-Proto"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"{http.request.scheme}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token property" style="color:#36acaa">"X-Real-Ip"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                                  </span><span class="token string" style="color:#e3116c">"{http.request.remote.host}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token property" style="color:#36acaa">"upstreams"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                          </span><span class="token property" style="color:#36acaa">"dial"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ip:8001"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>经过反向代理，登录页面可以打开，但登录后会报 csrf 的错</p>
<p>解决方法参考：<a href="https://github.com/haiwen/seafile/issues/2707" target="_blank" rel="noopener noreferrer">https://github.com/haiwen/seafile/issues/2707</a></p>
<p>修改 seahub_settings.py ，docker-compose 版本路径是： /opt/seafile-data/seafile/conf</p>
<p>添加一行，然后重新启动即可：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CSRF_TRUSTED_ORIGINS = ["https://abc.com"]</span><br></span></code></pre></div></div>
<p>此时可以登录了，但上传文件仍然抱错</p>
<p>登录后进入 <code>系统管理 - 设置</code>，设置 FILE_SERVER_ROOT SERVICE_URL 为 <a href="https://abc.com/" target="_blank" rel="noopener noreferrer">https://abc.com</a> 和 <a href="https://abc.com/seafhttp" target="_blank" rel="noopener noreferrer">https://abc.com/seafhttp</a></p>
<p>即可正常使用</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudreve">Cloudreve<a href="https://wjftu.com/blog/clouddrive#cloudreve" class="hash-link" aria-label="Direct link to Cloudreve" title="Direct link to Cloudreve">​</a></h3>
<p>文档：<a href="https://docs.cloudreve.org/" target="_blank" rel="noopener noreferrer">https://docs.cloudreve.org</a></p>
<p>新建文件夹和空文件。首先进入需要部署的的文件夹，输入以下命令</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -vp cloudreve/{uploads,avatar} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;&amp; touch cloudreve/conf.ini \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;&amp; touch cloudreve/cloudreve.db \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;&amp; mkdir -p aria2/config \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;&amp; mkdir -p data/aria2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;&amp; chmod -R 777 data/aria2</span><br></span></code></pre></div></div>
<p>官方 docker-compose.yml ，只需修改 RPC_SECRET。注意 docker-compose.yml 和上面建的 cloudreve 在同一层目录，而不是在 cloudreve 里面。</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"3.8"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">cloudreve</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloudreve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cloudreve/cloudreve</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"5212:5212"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> temp_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./cloudreve/uploads</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/cloudreve/uploads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./cloudreve/conf.ini</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/cloudreve/conf.ini</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./cloudreve/cloudreve.db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/cloudreve/cloudreve.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./cloudreve/avatar</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/cloudreve/avatar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aria2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">aria2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aria2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> p3terx/aria2</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> RPC_SECRET=your_aria_rpc_token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> RPC_PORT=6800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./aria2/config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> temp_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">temp_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">driver</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">driver_opts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">device</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $PWD/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">o</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bind</span><br></span></code></pre></div></div>
<p>启动</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up</span><br></span></code></pre></div></div>
<p>日志中可以看到用户名和密码</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cloudreve  | [Info]    2024-03-18 23:51:45 Admin user name: admin@cloudreve.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cloudreve  | [Info]    2024-03-18 23:51:45 Admin password: 43B6S1wb</span><br></span></code></pre></div></div>
<p>访问 <a href="http://ip:5212/" target="_blank" rel="noopener noreferrer">http://ip:5212</a> 即可进入</p>
<p>反向代理配置同上（配置反向代理前需要先通过 ip 访问，设置域名）</p>
<p>两者镜像比较：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">seafileltd/seafile-mc   latest    edc23e02abd9   5 days ago      1.33GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mariadb                 10.11     ba6f6d8eea0a   3 weeks ago     404MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memcached               1.6.18    0730201b15c1   12 months ago   89.3MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cloudreve/cloudreve     latest    328970d33c60   5 months ago    108MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p3terx/aria2-pro        latest    997da399fc5d   18 months ago   29.2MB</span><br></span></code></pre></div></div>
<p>体验下来感觉 cloudreve 界面更好一些，而且更加轻量，最终选择了 cloudreve</p>]]></content>
        <category label="网盘" term="网盘"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[折腾一个备案网站]]></title>
        <id>https://wjftu.com/blog/new-web-site</id>
        <link href="https://wjftu.com/blog/new-web-site"/>
        <updated>2023-12-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[因为无意看到有人用公网访问的对象存储搭建静态网站，突发奇想折腾一个备案的试试。域名在腾讯云购买，想着用七牛云的每月免费 10 G 流量的对象存储。国内建站的一个痛点是没有免费或低价服务器。如果是国外，很多免费静态资源托管，甚至很多免费 PHP 空间。国内的服务器一般几千元一年，一般只有第一年能享受几十元的价格。便宜的长期方案很少，腾讯云轻量无忧计划 180 元一年这种已经是很不错的了。纯静态网站可以用腾讯云 cloudbase ，现在优惠价 20 元一年，2 G 空间，5 G 流量，可备案，比国外免费的产品还差。]]></summary>
        <content type="html"><![CDATA[<p>因为无意看到有人用公网访问的对象存储搭建静态网站，突发奇想折腾一个备案的试试。域名在腾讯云购买，想着用七牛云的每月免费 10 G 流量的对象存储。国内建站的一个痛点是没有免费或低价服务器。如果是国外，很多免费静态资源托管，甚至很多免费 PHP 空间。国内的服务器一般几千元一年，一般只有第一年能享受几十元的价格。便宜的长期方案很少，腾讯云轻量无忧计划 180 元一年这种已经是很不错的了。纯静态网站可以用腾讯云 cloudbase ，现在优惠价 20 元一年，2 G 空间，5 G 流量，可备案，比国外免费的产品还差。</p>
<p>七牛的对象存储可以后付费，每月 10 G 免费公网流出流量。如果用用海外账号，无需实名，用起来体验挺好的。如果要介入国内的服务器，就要实名。公网访问可以提供免费 30 天的测试域名，长期使用需要绑定域名，国内账号域名需要备案。</p>
<p>有个问题，备案需要国内域名注册商加国内服务器，其实备案不一定需要有服务器，但要有服务器提供商的备案号，一种解决方案是咸鱼十几元购买一个备案号，不然就只能先买个服务器来备案。七牛是对象存储，不是服务器，不支持备案，国内要绑定域名又只支持备案域名，所以买了个新网备案号备了案，这样不知道是否合规，不过是可行的，用某个二级域名指向新网，也不会轻易掉备案号。然后在七牛通过 dns 验证域名，并 cname 到七牛指定的域名，即可使用对象存储通过域名公网访问。主页文件需要指定，其余文件的 url 就是文件路径。本地打包好，写个代码递归寻找所有文件，并使用相对路径作为 key 通过对象存储上传到七牛即可。试了一下，速度和体验良好，比自己托管体验好，自己的低价服务器带宽和性能毕竟不能和大厂比。</p>
<p>不过体验一下后就把网站迁到阿里云了，因为阿里云 ECS 轻量服务器有活动，99 元一年可续费 4 年，2C 2G 3M ，还可以，就买了。对象存储公网访问是不常用的行为，虽然免费 10 G ，但是如果受到攻击完全没办法防御，会被刷流量获得天价账单。虽然可以设置欠费停止服务，但有延迟。</p>
<p>新的网站源代码托管到 Github ，并使用 Github Actions 自动部署。当代码 push 时，自动使用 NodeJS 打包，并写了一个 GitHub Actions 通过 scp 命令把文件传到服务器上</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> xxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">build-and-deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">node-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'18'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> npm run build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          ls build/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wjftu/copy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">directory</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">via</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ssh</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">password@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">HOST</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.HOST </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">USERNAME</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">PASSWORD</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.PASSWORD </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">SOURCE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">TARGET</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /path/to/static/file</span><br></span></code></pre></div></div>
<p>Docker 打包了一个带有 sshpass 的镜像 <code>wjftu/sshpass:latest</code> 供此 actions 使用，这样做可能不太对，应该有现成的方案，或者更轻量的 NodeJS 的方案。</p>
<p>静态服务器用 caddy 部署，省去了手动申请证书，制作了一个 caddy 镜像，通过 -v 映射本地路径到证书路径，以免每次重启重复申请证书导致超出限制。</p>]]></content>
        <category label="备案" term="备案"/>
        <category label="网站" term="网站"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[椭圆曲线加密和 sm2 算法]]></title>
        <id>https://wjftu.com/blog/ecc-sm2</id>
        <link href="https://wjftu.com/blog/ecc-sm2"/>
        <updated>2022-04-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[椭圆曲线]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithStickyNavbar_LWe7" id="椭圆曲线">椭圆曲线<a href="https://wjftu.com/blog/ecc-sm2#%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF" class="hash-link" aria-label="Direct link to 椭圆曲线" title="Direct link to 椭圆曲线">​</a></h3>
<p><code>y^2 = x^3 + a x + b</code> ，其中 <code>4 a^3 + 27 b^2 != 0</code> ，a 和 b 为实数。</p>
<p>椭圆曲线与椭圆没有关系，只是长得像椭圆周长公式，所以称为椭圆曲线，是一种关于 x 轴对称的曲线，</p>
<p>定义一个“乘法”运算，椭圆曲线上一个点 A 与另一个点 B 运算，AB 可以连城一条直线，与椭圆曲线相交于一个点（只能相交于一点，或者相交于无穷远点），这个点关于 x 轴对称的点为 C ，<code>AB = C</code> 。由于椭圆曲线关于 x 轴对称，C 点也在椭圆曲线上。B 点 可以慢慢靠近 A 点，趋于 A 点时 <code>AA = 2A</code>，相当于定义了运算的标量乘法，相当于一条切线，切线也会于椭圆曲线相交于一个点，并得到 C 点。</p>
<p>这样的运算满足一些性质：</p>
<ul>
<li>封闭性：加上无穷远点后，A 和 B 都是集合中的成员，则 AB 也是。无穷远点相当于单位元，用 e 表示无穷远点， <code>eA = A</code></li>
<li>结合律：<code>A(BC) = (AB)C</code></li>
<li>交换律：<code>AB = BA</code></li>
<li>单位元：<code>eA = A</code></li>
<li>逆元：集合中的任意元素 A 存在元素 B，使得 <code>AB = e</code> ，A 和 B 互为逆元</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="有限域">有限域<a href="https://wjftu.com/blog/ecc-sm2#%E6%9C%89%E9%99%90%E5%9F%9F" class="hash-link" aria-label="Direct link to 有限域" title="Direct link to 有限域">​</a></h3>
<p>由于椭圆曲线在 x 和 y 轴上可以无限大，计算机不能处理无限大的数，需要用到有限域。选定一个大的质数 p ，运算的时候对 p 取模，这样得到的结果就是 0 到 p-1 到数。对于除法， <code>a^(-1) mod p</code> ，例如 <code>9^(-1) mod 23 = 18</code>，因为乘以 9 后可得 <code>1 mod 23 = 9 * 18 mod 23</code> ，所以 9 的逆元是 18 。 p 为素数保证了 0 到 p-1 每个数都有逆元。求逆元的方法为扩展欧几里得算法。</p>
<p>曲线上任意一点 p ，可以经过若干次标量变换后得到无穷远点，然后变回自己，这些点构成循环子群，元素个数为循环子群的阶。假设父群的阶是 N，子群的阶是 n，那么<code>h = N/n</code>一定是一个整数，h 被称为子群的余因子。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数学难题">数学难题<a href="https://wjftu.com/blog/ecc-sm2#%E6%95%B0%E5%AD%A6%E9%9A%BE%E9%A2%98" class="hash-link" aria-label="Direct link to 数学难题" title="Direct link to 数学难题">​</a></h3>
<p>给定曲线上两点 P 和 Q ，P 经过 k 次变换得到 Q ，<code>Q = kP</code>，求出 k 是一个数学难题，要一个一个点求，时间复杂度 o(n)。而知道 k 和 P ，求出 Q 却很容易，时间复杂度 o(log n)。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="密钥交换">密钥交换<a href="https://wjftu.com/blog/ecc-sm2#%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2" class="hash-link" aria-label="Direct link to 密钥交换" title="Direct link to 密钥交换">​</a></h3>
<p>Alice 和 Bob 约定好一条椭圆曲线，一个基点 G ，各自用一个随机数 dA 和 dB 生成一个公钥 Pa 和 Pb ，他们可以根据对方的公钥求出相同的密钥 S ，<code>S = dA Pb = dB Pa = dA dB G = dB dA G</code>，而中间人获取到两人的公钥 Pa Pb 却无法获得 S</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数字签名">数字签名<a href="https://wjftu.com/blog/ecc-sm2#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D" class="hash-link" aria-label="Direct link to 数字签名" title="Direct link to 数字签名">​</a></h3>
<p>签名：</p>
<ul>
<li>首先对待签名信息 m 进行哈希得到哈希值 z</li>
<li>生成随机数 k ，k 在 1 到 n-1 之间</li>
<li>求出 P 点， P = kG</li>
<li>计算参数 r ，r = xp mod n ，xp 为 P 点横坐标</li>
<li>计算参数 s ，s = k^(-1) ( z + r dA ) mod n</li>
</ul>
<p>(r,s) 构成签名</p>
<p>签名是一个表示 r 和 s 的长字符串，有 2 种格式，一种格式是 plain 格式，用一个 128 字符的 hex 字符串，前 64 个字符表示 r ，后 64 个字符表示 s</p>
<p>验证签名：</p>
<p>根据 r 和 s ，定义 u1 和 u2</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">u1 = s^(-1) z mod n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">u2 = s^(-1) r mod n</span><br></span></code></pre></div></div>
<p>验签的 Bob 可以根据 G 和 Alice 的公钥 Pa ，以及 s 和 t 计算出点 P ，算法如下：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">u1 G + u2 Pa = u1 G + u2 dA G = (u1 + u2 dA) G = s^(-1) (z + r dA) G = k G = P</span><br></span></code></pre></div></div>
<p>验证 P 的 x 轴坐标是否是 r</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sm2">SM2<a href="https://wjftu.com/blog/ecc-sm2#sm2" class="hash-link" aria-label="Direct link to SM2" title="Direct link to SM2">​</a></h3>
<p>SM2 标准椭圆曲线叫做 sm2p256v1，曲线的参数如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">p = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = 0x28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xG = 0x32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yG = 0xBC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">h = 1</span><br></span></code></pre></div></div>
<p>阶数很大，接近 2 的 256 次方，h 为 1 ，使所有点在同一个循环子群，安全性更高。指定一条椭圆曲线，可以避免弱曲线，而且各种参数已知。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sm2-签名和验签">SM2 签名和验签<a href="https://wjftu.com/blog/ecc-sm2#sm2-%E7%AD%BE%E5%90%8D%E5%92%8C%E9%AA%8C%E7%AD%BE" class="hash-link" aria-label="Direct link to SM2 签名和验签" title="Direct link to SM2 签名和验签">​</a></h3>
<p>hutool 签名 demo ，底层是 bouncycastle ，speed4j 底层也是这个</p>
<p>user id 在计算摘要时用到，两边约定好，不可超过 16 位，可为空，默认值为 "1234567812345678"</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">byte[] dataBytes="abcd".getBytes(); //待签名数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String userId="spdb.ebank.nbia"; //双方约定好的 user id ，可为空，默认为 "1234567812345678"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//私钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String privateKeyHex = "2FEA1D3EFF8668FCC663582AAF0F0300608F145DF5159717F24B3BAA5718561F";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final SM2 sm2 = new SM2(privateKeyHex, null, null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//使用 PLAIN 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sm2.usePlainEncoding();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//使用私钥签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] sign = sm2.sign(dataBytes, userId.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//转化为十六进制字符串，PLAIN 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String s = HexUtil.encodeHexStr(sign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println("Signature: " + s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//PLAIN 格式转换为 ASN1 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String asn1Sign = HexUtil.encodeHexStr(SmUtil.rsPlainToAsn1(sign));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println("ASN1: "+asn1Sign);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//ASN1 格式转换为 PLAIN 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String plainSign = HexUtil.encodeHexStr(SmUtil.rsAsn1ToPlain(HexUtil.decodeHex(asn1Sign)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println("PLAIN: "+plainSign);</span><br></span></code></pre></div></div>
<p>输出：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Signature: e01a75085bb6bd9ccaf17cd96990a0c63b4fb1676a72cded49cfe9e7b7badd7bd6a125beec73f659458d6ee5c075bba0e65df2c786c6881cfdf038de90d06574</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ASN1: 3046022100e01a75085bb6bd9ccaf17cd96990a0c63b4fb1676a72cded49cfe9e7b7badd7b022100d6a125beec73f659458d6ee5c075bba0e65df2c786c6881cfdf038de90d06574</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLAIN: e01a75085bb6bd9ccaf17cd96990a0c63b4fb1676a72cded49cfe9e7b7badd7bd6a125beec73f659458d6ee5c075bba0e65df2c786c6881cfdf038de90d06574</span><br></span></code></pre></div></div>
<p>用公钥验证签名</p>
<p>公钥开头的 04 表示未压缩公钥，后面 64 位为 x 轴坐标，再 64 位为 y 轴坐标。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Plain 格式的签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String plainSign = "e01a75085bb6bd9ccaf17cd96990a0c63b4fb1676a72cded49cfe9e7b7badd7bd6a125beec73f659458d6ee5c075bba0e65df2c786c6881cfdf038de90d06574";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ASN1 格式的签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String asn1Sign  = "3046022100e01a75085bb6bd9ccaf17cd96990a0c63b4fb1676a72cded49cfe9e7b7badd7b022100d6a125beec73f659458d6ee5c075bba0e65df2c786c6881cfdf038de90d06574";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 公钥，04 开头未压缩格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String publicKeyHex ="04138C0C8EEA76E2AB3DCE4AAFA195F4EADF34ABF48629659770C6A04D7D0CBF32590488AB33734628C4BEE413EB20A2B4B1B3173153CFA2D50C06F90A3B78A654";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//需要加密的明文</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byte[] dataBytes = "abcd".getBytes();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// user id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">String userId = "spdb.ebank.nbia";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final SM2 sm2ASN1 = new SM2(null, ECKeyUtil.toSm2PublicParams(publicKeyHex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean verifyASN1 = sm2ASN1.verify(dataBytes, HexUtil.decodeHex(asn1Sign), userId.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println("ASN1: " + verifyASN1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final SM2 sm2Plain = new SM2(null, ECKeyUtil.toSm2PublicParams(publicKeyHex));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 设为 plain 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sm2Plain.usePlainEncoding();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boolean verifyPlain = sm2Plain.verify(dataBytes, HexUtil.decodeHex(plainSign), userId.getBytes());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println("Plain: " + verifyPlain);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a href="https://wjftu.com/blog/ecc-sm2#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" class="hash-link" aria-label="Direct link to 参考资料" title="Direct link to 参考资料">​</a></h3>
<p><a href="https://www.jianshu.com/p/5b04b66a55a1" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/5b04b66a55a1</a></p>
<p><a href="https://www.hutool.cn/docs/#/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-AsymmetricCrypto" target="_blank" rel="noopener noreferrer">https://www.hutool.cn/docs/#/crypto/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-AsymmetricCrypto</a></p>]]></content>
        <category label="ECC" term="ECC"/>
        <category label="SM2" term="SM2"/>
        <category label="加密" term="加密"/>
        <category label="签名" term="签名"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[封控日记]]></title>
        <id>https://wjftu.com/blog/quarantine-diary</id>
        <link href="https://wjftu.com/blog/quarantine-diary"/>
        <updated>2022-04-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[自从 2022 年 3 月 18 日起，因为疫情小区被封，中间仅解封一天。4 月 10 日开始写日记记录一下隔离生活，此日期前的内容为回忆。]]></summary>
        <content type="html"><![CDATA[<p>自从 2022 年 3 月 18 日起，因为疫情小区被封，中间仅解封一天。4 月 10 日开始写日记记录一下隔离生活，此日期前的内容为回忆。</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-8-日">4 月 8 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-8-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 8 日" title="Direct link to 4 月 8 日">​</a></h3>
<p>发现了前室友没拿走的牛奶，虽然过期 8 个月，不过味道一点也没变，好开心。告诉室友，问他要不要，他觉得还是算了。。</p>
<p>今天团的曼可顿的面包到了，豆沙面包没有了，结果换了更贵的，挺良心。送货的还是个外国小哥，会说中文。吃了面包，很有满足感，六个大面包可以吃很久了，解决主食问题。室友也团了这个。</p>
<p>有消息说京东 11 日开始送货，不知道是不是真的，又买了一些，不过此时觉得不缺东西，肚子也很饱，也没有买很多，买了蚝油、麦片、瓜子、饼干、苹果醋、果汁。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-9-日">4 月 9 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-9-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 9 日" title="Direct link to 4 月 9 日">​</a></h3>
<p>一大早去居委会分抗原，又是做抗原的一天，而且今天要做两次。先到了第一批的抗原，由于两次要间隔 4 小时，就先把第一次的分发给楼组长，楼组长分发下去。然后第二批的到了，再次分发给楼组长。然后有居民第二次下来取抗原时很不满，说每次下楼一次就要用一个口罩。</p>
<p>太早没吃饭，顺带拿了两桶泡面回去。中午把要坏的蘑菇煮了，和泡面一起吃，好久没吃泡面，好好吃啊！</p>
<p>今天发了一箱菜，还有一袋米，菜冰箱放不下了，只能放外面，又要送菜给别人了。这次有较为珍贵的黄瓜和芹菜。有人说这个米只能煮粥？？什么意思？</p>
<p>下午突然通知要核酸，然后又报名了核酸志愿者。穿好防护服后等医生用了很长时间，在居委会吃了一些西梅，这是很久以来第一次吃水果，好好吃。居委会有些水果，都快放坏了，核酸结束后又拿了几个。今天挺热的，太早粘上防护服胶带的人有些后悔。</p>
<p>今天开始不用健康云的核酸码了，用随申办的核酸码。提前申请核酸码，系统崩了，随申办、微信小程序、支付宝小程序都不好用，试了几十次才在支付宝中弄好。用随申办就不能像以前一样帮别人申请了，只能帮亲属申请，并要提供证明材料，如果以前没有帮亲人申请过随申码的现场弄是不行的。群里有人说，在其他小区，已经是灾难，变成自愿核酸了。这次可以用身份证，并可以用亲属的身份证录入，如果用身份证会稍微慢一点，会用摄像头识别身份证的文字录入信息，由于识别可能会错误，有时需要人工修改。如果没有身份证也可以手动录入信息，不过扫码的医生对此很不耐烦，一般都叫他们回去拿身份证，对于身份证摆放方向错误的人也很不耐烦。</p>
<p>果然是灾难的一天，不过比想象中的好一些。又是收获各种抱怨，有人觉得码变了很烦，有人被劝回去拿身份证，然后看到有其他人没有身份证也录入的就觉得不满，有人觉得天天核酸，而且一天两次核酸一次抗原，不想做了，核酸码半天弄不出来也烦人。傍晚的时候情况有些好转，核酸码大部分都能出来了，支付宝出来的概率大一些。天黑了核酸才做完，也有其他小区更晚，甚至凌晨做的。</p>
<p>这次核酸的时候遇到了理发店的居民，问一个人有没有兴趣去方舱医院工作，看起来积极性不高，估计想帮他们也是不容易的。</p>
<p>核酸做了三分之二的时候，蛋糕好了，抽空送了个蛋糕，穿着防护服送蛋糕。这次是坚果面包，也有我的一份，核酸做完后当晚餐，非常好吃。华理小组的人很羡慕。</p>
<p>有人送了一袋菜来，有肋排、炸猪排、鸡米花、肉丸、包菜、西红柿、腐竹、竹笋，写的我们都门牌号，我以为是室友的，室友开始以为是他团的，结果发现不是。尝试找失主，找不到第二天送掉。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-10-日">4 月 10 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-10-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 10 日" title="Direct link to 4 月 10 日">​</a></h3>
<p>又是线上主日，不知道什么时候才能线下聚会。</p>
<p>今天小区补发了一个鸭子，挺多人喜欢的，还说要边喝酒边吃。</p>
<p>帮忙送快递的一天。今天兔妈妈志愿者给今天的志愿者送了西梅（是居委会的西梅吗？），我有幸拿了一包，点赞，封闭期间水果珍贵。奶茶店的志愿者又给大家做了柠檬红茶，不过没拿到。今天并没有参与志愿者的接龙，只是去帮帮忙。桑看到我经常出现，问我是志愿者群里的哪位，还怕我工作太累了。今天顺便也帮了一些团长送货，一个 80 斤的上海小姑娘是个活跃的团长，中午分发香蕉，晚上又组织团购肉。今天有几个京东快递，看起来不像必需品，可能京东要开始送了，还有美团的食物外卖。张书记为志愿者提供了鸡蛋、挂面、大米团购，大米 20 斤 100 元，金龙鱼挂面 15 一把，草鸡蛋 50 一板，比团长们的略贵，有挺多人买的，我食物太多了，不需要。</p>
<p>今天送蛋糕，陈师傅的蛋糕还是很抢手。有幸得到了陈老师送的边角料，很好吃。送的时候顺便把菜送给群里的一些人，并帮群里一些人跑腿，有人送了两个苹果给我，还有人送了一罐可乐，都是很珍贵的物资，非常感谢。居民们互相传递需要的物资，挺有爱的。陈老师说我看起来很年轻，像学生。</p>
<p>昨天错送过来的菜，还是无失主认领，于是送人了。肋排和腐竹送给一个人，他送了些香蕉给我。炸猪排、丸子、鸡米花送给另一个人，他是封控楼的，送一些雪碧、橙子、龟苓膏给我，封控楼不容易，我只要了一个雪碧、龟苓膏、橙子。</p>
<p>室友团的冻品和菜到了。这些都是他在恐慌中团的，然后现在觉得不需要，在群里转让，很快就转出去了。</p>
<p>今天还有人买香烟，其中还有志愿者。让跑腿的人买的，跑腿费一次 50 。香烟现在上硬通货，很值钱。其他城市屯粮的可以考虑一下香烟，可以用来换其他东西。</p>
<p>晚上溜小白狗的阿姨去大门附近遛狗，她还说志愿者要好好保护自己，我以为她天天出来是不怕疫情，不过她说她担心疫情。见到门口分发食品的团长，她也想团购，可是不会弄，让团长拉进群。团长见她不太会用微信，直接卖了一袋面包给她，在团长指导下，微信付款成功。老年人在团购中也是挺弱势的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-11-日">4 月 11 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-11-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 11 日" title="Direct link to 4 月 11 日">​</a></h3>
<p>平凡的一天。</p>
<p>今天开始一些区域分为封控区、管控区、防范区。我这里自然上封控区，防范区好像可以一户一天一人一小时出去活动。</p>
<p>晚上送全家时送到一家楼下，按门铃结果说没订，然后打上面的电话，才知道上面的地址写错了，然后她去门口找了。我说放在她楼下了，然后去旁边玩一会儿猫。然后她过来了，给我一包零食，后面一边吃零食一边送好开心。</p>
<p>晚上昨天那个团长又在清点货物，这次是猪肉。她想送封控楼，但大白不让，结束时她让我送去了。一个封控楼的说：天天遛狗的一堆，基本需求都不给送的话有点说不过去吧，难道我走出去他们就不怕了么……我已经快憋屈坏了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-12-日">4 月 12 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-12-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 12 日" title="Direct link to 4 月 12 日">​</a></h3>
<p>中午大热天出去送了一下快递，被一个阿姨夸，还问了我的门牌号。后来每见一次夸一次。其实我只是想出来活动活动，顺便服务一下大家。中午没有人送，然后又有肉，怕坏了。快下午上班的时候我走的时候架子上还有很多，只能把肉送完。</p>
<p>今天面包师傅休息，不做，明天有雨担心不好送也不做。群里对面包盼望比较大。晚上帮晟晟妈妈送面粉给面包师傅，晟晟妈妈送了我修复乳和洁面乳 demo ，是她上次就想送我的，还有一瓶美年达，很感恩。</p>
<p>晚上 82 号楼有个小姐姐把 82 号楼的两个理发师拉进来了。理发店是群居房，之前因为人多没有吃的了来找居委会要，群里一些人觉得反感，不来当志愿者却要食物。终于有好心人关心他们了。</p>
<p>晚上送货时一个阿姨着急地问我居委会为什么没人，我说 8 点后就没人了。她很急，因为 37 号有个人出了很多血，要去居委会拿社保卡。我让她先去找门卫，然后我在群里联系。不久后居委会来人帮忙找到了社保卡，我小三轮带着取社保卡的邻居过去，救护车已经来了。人没事，挺清醒，脖子上有伤口，已经止血并在输血。围观群众问我怎么回事，担心是感染，还问我小区有没有阳性。</p>
<p>晚上安妮的水果群有人送可乐和咖啡，79 号的大爷，太大方了，赶紧各去拿了一罐，想送红肠当回礼，他不收。可乐和咖啡都是硬通货，好多人想要，很多人说第二天找他拿。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-13-日">4 月 13 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-13-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 13 日" title="Direct link to 4 月 13 日">​</a></h3>
<p>上午又是全员核酸， 5 人一管。今天下雨，不过好在做核酸的时候雨很小，不需要打伞。午后，雨变大了，然后快递还说源源不断地来，堆成山，是个灾难。</p>
<p>下午在群里问有没有人有零食，过期的也可以，可以用菜和肉换。 83 号一个大姐家里有，让我去拿。又有一个 7 号的人红肠买多了，要卖。83 号的大姐买一根，昨天 79 号的大爷买两根，83 号的大姐还说请把红肠留着，因为大爷走路慢（其实大爷身体好像挺好的，也不老），但随后又问我什么时候去拿零食，然我顺便帮忙送一下红肠，于是我出发送红肠。给 79 号大爷送红肠，大爷又给了我一罐可乐，并让我给 96 号封闭楼的人送两罐，有个女孩子一个人，大爷觉得她可怜。然后给 83 号楼送红肠，她给了我零食，但红肠她退掉了，因为她是好心帮邻居买的，但邻居不要了。挺大一袋零食，谢谢她的慷慨。送可乐给她当回礼她不要。</p>
<p>今天有医生来给 5 号楼复测，下雨天，医生挺厌烦的。而 80 号楼抗原自测阳性的，这几天抗原都没问题，他很认真对待，同楼的人也很关注，但就是没有人来测。</p>
<p>晚上冒雨帮忙送快递，穿着防护服，防护服可以防雨。雨天送快递挺艰难的。有两个人在封控楼，想让我帮忙找一下，但找不到他们的。回家之后群里又有人要送东西，然后又去帮他们送了，短袖短裤出门。有个阿姨觉得天气不好我还穿短袖短裤出来太过了，其实还好。群里也有人觉得我太晚了还出去，有人想送可乐和姜茶给我，谢绝了。封闭前没有可乐，封闭后我有 3 罐了，都是好心人送的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-14-日">4 月 14 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-14-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 14 日" title="Direct link to 4 月 14 日">​</a></h3>
<p>又一次全员核酸，早上开始，直到下午才到我，毛毛雨，可以不用打伞。</p>
<p>中午公司的物资到了，有些人两天前就到了，有些人今天还没到。一个大白萝卜，一个花菜，一些绿叶菜，一个莴笋，几个西红柿，黄瓜，两瓶油，一箱牛奶，一板鸡蛋，三包挂面，两个午餐肉罐头。德邦物流送货，包装得挺好，没有损坏。</p>
<p>中午帮忙送快递。然后送菜的车来了，帮忙卸货。运物资的人看起来是外地的，可能是从外地来支援的。帮忙卸货，相当于健身了。每户有一只鸡一箱青菜。两批菜加起来有些多，送了一些给 83 号楼的大姐，她又送了一小盒芝麻糖和两个自己制作的手抓饼给我。但是他们楼下也在发菜，有些人想要双份与工作人员争吵。</p>
<p>晚上帮忙跑腿送面包，同时帮一些人跑腿交换物资，有人送了一个橙子。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-15-日">4 月 15 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-15-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 15 日" title="Direct link to 4 月 15 日">​</a></h3>
<p>早上带线上晨祷，结束后精神很好，没有继续睡觉。然后群里有个居民想让人帮她送一下东西，就出去送了，只送了这一单。 9 小箱牛奶和酸奶，很大一箱鸡蛋，大户人家。</p>
<p>早上 21cake 的群里有些不满情绪，因为小区开始限制团购，团长要签保证书，出事要负责，然后蛋糕这种团购可能不会批准。封控挺不容易的，把很多人的蛋糕梦破灭了情绪会不太好。其实蛋糕团购还是挺有秩序的，比零散的买菜好送多了，我觉得可以有，可以提高幸福感。不过我们的居委会可能也算还不错的了，没有一刀全切掉。</p>
<p>今天有一辆车开出去了，有人家里要生孩子。据说开出去就不能回来了，不知道他们以后住哪，月子中心？</p>
<p>下午 83 号楼的阿姨又送了很多零食，还拉了 93 号的另一个大姐送的。93 号的大姐之前还在群里找跑腿的，现在物价和跑腿费都贵。非常感谢她们。给她红肠她也不收。</p>
<p>菜又吃不完，送了一些给 38 号的大姐。很久以前送过一次卷心菜和土豆给她，她家小孩只吃土豆、胡萝卜、卷心菜、杭白菜之类的，她也给了我半瓶油。这次给了我一袋糖，真好吃。今天发菜后又给她送了花菜、绿叶菜、包菜，她说小孩很开心，还送我一包速冻水饺和一包豆子。我推辞，她说小孩只吃新鲜的，硬送给我了。</p>
<p>今天附近一个小区的某个业主联系的云南送来的物资带了，没人一袋蔬菜，有西红柿、花菜、绿叶菜、黄瓜、包菜，帮忙卸货，又是健身。晚上协助发菜。发到最后穿上防护服发封控楼道。封控楼道是上门发的，不是每户下来取，我本以为封控楼道的人封闭久了见到有人敲门会比较开心呢，结果大部分并不想见人，有的会等你离开再开门取，有的开门后不断喷消毒水。</p>
<p>发完菜拿了一些多的回去，然后又在群里发掉大部分了，有个大姐收到后一定要给我两瓶牛奶，不收她就不要了，还有个封控楼的给了些水果和咸蛋，我觉得封控楼不容易，不要，但她也是硬要给。路上还碰到一个人，她问我是不是送蛋糕的，说她收到过，然后想把手中的零食分我一些，这个是我唯一成功拒绝掉的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-16-日">4 月 16 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-16-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 16 日" title="Direct link to 4 月 16 日">​</a></h3>
<p>早上多睡了一下，下午学习一下，晚上送送快递。之前有消息说京东 11 日开始送货，当时买了一些，不过并没有送，今天其中的一包瓜子到了，其它订单没变化。今天快递更严格了，要看送快递员的核酸，没有的当场做抗原，感觉挺耽误她们工作的。对于居民自己去快递，也有人会说他们。帮蛋糕师傅送瑞士卷，得到了她的边角料，很好吃。晚上还是有人出来散步、遛狗，还看到一个老年人在偏僻的地方偷偷跑步，关太久了居民们不容易。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-17-日">4 月 17 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-17-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 17 日" title="Direct link to 4 月 17 日">​</a></h3>
<p>上午又是全员核酸。核酸后给 83 号大姐送了两包挂面，公司物资里的挂面，因为她昨晚在一个群里想买。她想给我一些橄榄或钱，谢绝了。</p>
<p>上午又到了一个京东快递，是饼干，京东的订单一直显示 4 月 22 日到，但是突然就可能收到一个。很好吃，一下子吃了很多</p>
<p>下午送快递，遇到 42 号的老奶奶。之前她让我帮忙留意一下有没有牛奶，想买金典 12 瓶 60 元的，团购也是这个价。特仑苏 12 瓶 68 元的附近有个超市有，每天都可以送货，她觉得贵。昨天看到有个人在群里卖金典 55 元，就让那个人联系她了。她突然收到牛奶，她问我是不是我帮忙的。她还说一直不发肉，菜发太多了，之前的鸭子太辣了她吃不了。她让我帮她留意一下水果，现在水果太贵了，橙子 20 元一斤，苹果 10+ 元一斤。今天对快递检查得较严，当场测抗原，昨天做了核酸都不可以，挺耽误快递工作的。网上一些信息说快递员很多有问题的，不知道真假。有个老奶奶买了兔子食物，但是送货的拒绝做抗原，然后走了，有志愿者觉得他有问题。后来老奶奶还是想办法拿到了货物。</p>
<p>这次送快递意外发现小区一些特别的地方，有一户人家好像是信鸽协会的，养了好多鸽子。还有个地方有猪笼草，还有个地方有个小秋千。</p>
<p>晚上送面包，有人给了一瓶鲜奶，很好喝。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-18-日">4 月 18 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-18-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 18 日" title="Direct link to 4 月 18 日">​</a></h3>
<p>昨天加了居民群。今天群里很多居民希望居委会能把小区的情况透明地公布一下，不过毫无回应。因为昨天又有几个人拉去隔离，然后保安室好像也说要封但取消了，居民们没有确切消息。在志愿者群里也建议了一下每天公布日报，不过也没有回应。</p>
<p>今天又是全员核酸，这次是一人一管。早上核酸的时候快递如山，不过我没去。</p>
<p>下午送出去半块鸡胸肉和 6 个鸡翅根，得到别人赠送的一包螺狮粉。有个人养猫所以在群里求鸡胸肉。下午帮忙送面包，得知这是最后一次了，因为材料不够了。陈陈师傅还给我准备了一些菜和一个绿豆汤，有大块牛肉，很好吃！试着帮她在京东买一些材料，奶油没有，高筋粉低筋粉和糖有，但不知道能不能顺利发货。</p>
<p>晚上送快递前先帮忙送药，有些人的药少配了，因为配不到。比较意外这次快递不多。 17 号又把柯基放出来了，和它玩了一下。还有一户人家凭证明文件出去了，房子到期，搬到旁边的大上海国际花园，一辆电动车一辆轿车带着行李和两个娃，然后出去就不能回来了，疫情期间搬个家不容易。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-19-日">4 月 19 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-19-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 19 日" title="Direct link to 4 月 19 日">​</a></h3>
<p>今天帮 26 号的小姐姐跑腿，昨天送了她鸡翅根，今天她送我一个苹果一个橙子。</p>
<p>中午对面人喊没饭吃了，但听起来像是在发泄，而不是真的没饭，就没有管。201 的邻居也在志愿者群里，她在群里发了一下。</p>
<p>今天小区群里终于公布了昨天哪些楼道出现阳性，几个人被隔离。小区群里有人提出对居委会进行监督，也有人争论清零还是共存。</p>
<p>白天快递比较多，堆成山，晚上我去的时候好很多，提前回去了。今天我又到了一个京东，一个订到被拆成很多个小订单。虽然今天蛋糕师傅没有像以往一样做 10 个人的面包或瑞士卷，但还是为两个家庭做了蛋糕，有小朋友生日，纯蛋糕，没有奶油或其它东西。她还让我帮她留意一个快递，不过没有看到，可能是送错地方了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-20-日">4 月 20 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-20-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 20 日" title="Direct link to 4 月 20 日">​</a></h3>
<p>早上抢到一个美团买菜，不仅提交要抢，付款也要抢，都试了几十次才成功。美团上面菜很少，水果很少很贵，方便面只有 1 种，这次只抢了薯片、好丽友派、方便面。很好吃，后悔没多抢一点。</p>
<p>早上全员核酸，10 人一管。遇到了 201 的邻居，之前海霞想让我们楼道建微信群，于是就叫她当群主，她答应了。</p>
<p>今天业主群里也公布了日报，有核酸、消杀、物资配送、配药等内容。另外今天开始团购暂停了，然后推出官方团购，价格也很一般。</p>
<p>晚上送快递时看到有车来拉两个阳性居民去隔离，4 号楼两个人穿着防护服拉着行李自己走出去。然后物业对他们走过的地方进行消杀。这几天晚上会有物业巡逻劝居民回去，再晚一点就没有人了，然后又遇到很多遛狗的人。小白狗阿姨看不清手机上的团购信息，让我帮她看一下，她还想帮一个邻居问一下没有米怎么办，觉得现在物价太贵了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-21-日">4 月 21 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-21-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 21 日" title="Direct link to 4 月 21 日">​</a></h3>
<p>今天全员核酸。打印了一个楼道群二维码，趁着大家一起下楼的机会，让楼道居民加了楼道微信群。才发现好多人不会扫码加群的。小区开了官方的团购，然后发到群里，有一户人购买。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-22-日">4 月 22 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-22-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 22 日" title="Direct link to 4 月 22 日">​</a></h3>
<p>上午 30 和 31 的楼组长阿姨来找我，拿着昨天的微信群二维码，问我是不是我们楼道的二维码，然后加了群。然后又拿着这个二维码走访几个昨天漏加群的邻居，都加上了。后面一些事情就在群里通知了。</p>
<p>下午有人说小三轮坏掉了，我去送快递的时候看了一下，链条掉了，然后装好链条，以为修好了。骑了一趟后，真的坏掉了，飞轮空转，三轮车光荣牺牲。群里好多人觉得这个三轮车用处很大，应该颁发个锦旗。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-23-日">4 月 23 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-23-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 23 日" title="Direct link to 4 月 23 日">​</a></h3>
<p>今天又是全员核酸，10 人一管。有一点毛毛雨，防护服可以防雨，但是鞋套会进水，鞋湿了。这次和广鹏一起，叫的时候，如果居民说不下来，我们可能会多叫几次，不下来也不会强求。 66 号有个人说不下来，然后就不下来了。她在居民 1 群里，说了不做核酸的经历，然后有志愿者截图发在志愿者群里了，然后遭到大量反对。66 号的人也在志愿者群里，然后就有一些争吵，66 说她是在讨论可不可以不做核酸，但很多人反对她，觉得她是带头不做，或者是煽动大家不做。争吵后她退群了。</p>
<p>后来我发了段信息到群里：今天66号的是我和广鹏去叫的。其实遇到好几个不做的，有的是怕感染，有的是老人，有的生病或受伤，有的不满我们做过75号，有的封控楼不敢出门，也有人虽然很不满但还是来做。如果他们不做我们也不强迫，通知到就行，真有法律责任就按法律。现在大家都不容易。法律过于倾向政府，做核酸感染政府也不负责，居民情绪也不好，还是多与居民保持和睦。</p>
<p>尽量委婉，本以为也会有些争吵，不过得到点赞。。</p>
<p>今天核酸的过程有些小亮点。有几个阿姨认出我是那个常送快递的人，夸我。发现居民摘樱桃，自己也摘了两颗尝尝。</p>
<p>昨天团购的物资今天到了，然后我这栋唯一参与的那家人，没有提交成功。。。看来应该亲自帮他们操作。。然后今天又开了新的团。他们又参与了。这个是居委会的官方团购，居委会和团长们一直有些小冲突，居委会希望减少不必要物品的团购，而且会觉得团购配送麻烦。团长们其实为物资和配送做了很大贡献，我觉得团购还是很好的，比零散购买又便宜又方便又安全。居委会的官方团购也挺不错的，不收回扣（听说很多东西供应商主动给回扣），而且通过楼道群通知，覆盖广。</p>
<p>傍晚送了一下快递，有人开了一辆哈罗给我骑，好久没骑哈罗，觉得很好骑，比三轮车那种低坐垫的好骑很多，虽然哈罗坐垫也不高。晚上 22 号的阿姨也在门口，之前多次说要夸我的，然后让我拿两件快递摆拍一下，谢绝了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-24-日">4 月 24 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-24-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 24 日" title="Direct link to 4 月 24 日">​</a></h3>
<p>上午京东到了一包麦片。下去取的时候正好 202 的也到了，然后顺手拿上去。给她的时候顺便开玩笑问她有零食吗？她说有坚果，然后我说是开玩笑的，但她说吃不完，坚持给了 10 包每日坚果，好大方。想回礼，但都不要。</p>
<p>今天官方团购又开了蔬菜团和苹果花园面包团，昨天的蔬菜限量，面包被抢完，今天我团了面包。</p>
<p>中午去帮忙送快递，然后 22 好的阿姨又来了，然后她成功拍到了。中午官方团购的鸡蛋来了，然后帮忙卸货，中午正是缺人的时候，只有我和两个大姐一个阿姨。</p>
<p>晚上有救护车过来，把 84 号一个人拉走了，看起来像肚子疼，不严重。晚上 202 的公司物资到了，帮她拿了上去。她给了 6 罐百事给我，真大方。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-25-日">4 月 25 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-25-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 25 日" title="Direct link to 4 月 25 日">​</a></h3>
<p>全员核酸，10 人一管。由于有人不做核酸且较强硬，导致群里对于不做核酸的人有情绪。其实我觉得居民们也很不容易，被封这么久，物资不足，无法工作，还要反复核酸。。。</p>
<p>今天下了一阵又短又大的雨，天气很舒服。晚上送快递时又遇见 17 号的柯基，这次主人牵着出来，以往都是主人在楼道口，让它自己出来活动。主人说狗关在家里，都快生病了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-26-日">4 月 26 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-26-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 26 日" title="Direct link to 4 月 26 日">​</a></h3>
<p>今天又是全员核酸，10 人一管，全市一起做。然后中途系统崩了，停了一阵，虽然一大早就开始，但下午才叫道我们。快递又是人手不够，因为核酸分了很多人走，然后京东又送来很多。中午出去遇见了 83 号的大姐，没认出她，问她要不要菜，准备把今天将要发的菜给一些给她。今天又发了一批素菜，送了一些土豆和红肠给 38 号的大姐，她给我两个咸鸭蛋和几包奥利奥饼干，很好吃。她说她们单位可能下个月就要扣钱了，她在办公室还好，生产线上的工人可能扣比较多。她也觉得被关很久了，而且她做过手术，身体不太好，不敢在外面活动。孩子比较挑，要吃新鲜肉，买过的鲜肉是有味道的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-27-日">4 月 27 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-27-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 27 日" title="Direct link to 4 月 27 日">​</a></h3>
<p>早上成功抢到美团买菜，其实前两天也抢到了，但付款也要抢，然后付款没抢到，超时取消了，今天的成功付款。不过最终只买到两盒 Q 蒂和一包薯片。。。</p>
<p>42 号的阿姨之前问我哪里有卖挂面，想买 10-15 元的，虽然一个群里有，但是要跑腿费，就不合算。今天在群里随便问一下，马上有人愿意给。区 85 号找她拿，给她钱也不要。42 号阿姨收到很感激，觉得一定要给钱，就把门牌号告诉她了。她之前问我哪有卖香烟，儿子要买烟，3 元一包的，我觉得不可能买到，但今天她告诉我买到了，真神奇。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-28-日">4 月 28 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-28-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 28 日" title="Direct link to 4 月 28 日">​</a></h3>
<p>昨晚理发店的小哥在群里发鸡肉的团购，之前发的鸡我吃了一半，觉得好难吃，就问他要不要，然后今天就送给他了。他问我要不要剃头，我说我自己剃。昨晚还问他是不是疫情对工作影响很大，他说基本是失业了。他有些朋友已经在小区里提供理发服务了，他也准备做，10 元一次，但由于现在还不是防范区，只能偷偷做。</p>
<p>中午送了一小会菜，又被 22 号的阿姨拍照了，路过 90 几号的时候，唐阿姨问了我是哪里人，工作情况，想给我介绍对象，不过觉得我太年轻了。我告诉她另一个阿姨的儿子单身，但她觉得不靠谱的不敢介绍。中午 87 号门口的 4 只小猫在睡午觉，非常可爱。经常路过的时候摸一摸，那里有个阿姨在照顾。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-29-日">4 月 29 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-29-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 29 日" title="Direct link to 4 月 29 日">​</a></h3>
<p>今天升级为防范区，但是还是会劝居民不要出来，但出来的人更多了，大家闷太久了。</p>
<p>79 号陈强的热水器坏了，过去帮他看了一下，不会弄。。好旧的热水器，没有打火的声音，可能是打火器坏了，电源灯是亮的，灶台可以打火。最后只能帮他问了物业的电话，然后他又要了苏宁的电话，联系那边买了一台新的，旧的可以 20 元回收。他给了我一个甜瓜两个粽子，可惜没帮上忙。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-月-30-日">4 月 30 日<a href="https://wjftu.com/blog/quarantine-diary#4-%E6%9C%88-30-%E6%97%A5" class="hash-link" aria-label="Direct link to 4 月 30 日" title="Direct link to 4 月 30 日">​</a></h3>
<p>今天又有物资发放，两桶挂面，一包盐一包糖，一盒午餐肉，还有一袋小面包！</p>
<p>今天业主群里面有些争吵， 20 号有个多多买菜，有人说他们靠团购赚黑心钱，团购群里有人发更低价的就会被他们踢出去，也有人说他们团长不好当。他们和理发好像有关系，有人提到理发小哥了。然后书记让发哥和理发小哥向居民说明情况，居委会没有同意他们提供理发服务，他们说只是统计，等解封后才开始。。。理发小哥的想法泡汤了。。</p>
<p>89 号照顾小猫的阿姨问哪有卖猫粮，她已经在用最后一袋了，而京东一直不发货。帮她在群里问一下，小区好多养宠物的，他们说美团饿了么都有，而且还有宠物群。</p>
<p>今天晚上送快递的时候有个肯德基的地址写了 5 号和 12 号，结果 5 号说不是他的，12 号没人，就放楼下了。后来小杨问我是不是送了一个肯德基，告诉我那个地址错了，是 12 区的，然后拿回去放货架了。发现货架上还有一个三区的也送错过来了。快 12 点的时候，想着如果快递员没有来拿，就去拿来吃了，结果真的没有来拿，就拿回来吃了，不浪费。吃到肯德基好开心。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-1-日">5 月 1 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-1-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 1 日" title="Direct link to 5 月 1 日">​</a></h3>
<p>现在菜变得好抢了，6 点半美团抢了一些好丽友零食，点几次就进去了。也有其他人说现在不用 6 点抢了，6 点半好抢一些。</p>
<p>听说昨天 52 号一个老人吃饭噎着去世了。</p>
<p>上午核酸，去做了志愿者。中午帮忙卸货，今天到了一批牛奶。现在物资非常充足了。</p>
<p>给了一袋昨天的物资给 83 号的阿姨，她给我一份自己做的炒饭。陈强问我不做饭吗，让我自己留着点，以防万一，也不要被贪小便宜的人利用了，实际上他比我大方多了。把火腿和午餐肉给楼上的邻居，她给了我 4 瓶酸奶，很久没见酸奶了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-2-日">5 月 2 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-2-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 2 日" title="Direct link to 5 月 2 日">​</a></h3>
<p>昨天在宠物群里发了 88 号门前生了几窝野猫的信息，然后今天有人去领养了一只。下午有几个人一起去看小猫，并帮它们洗眼睛，洗耳朵，滴眼药，一些小猫的眼睛张开了。之前好像有传染病，眼屎很多，而且有些睁不开。第一次见这种操作。</p>
<p>下午去看了一下书，遇到 83 号姚阿姨，和她聊了一下。她也关心我吃饭问题，给我一碗竹笋肉汤。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-3-日">5 月 3 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-3-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 3 日" title="Direct link to 5 月 3 日">​</a></h3>
<p>今天又发了生活用品，沐浴露、卫生纸、牙膏，等等。另物资等时候楼组长叫我教 102 的大爷团购，早知道之前看到他在群里问的时候就主动教他了。对门邻居想要挂面，就送了之前发的 2 筒给她，她送我一些梨。后来在楼道群里问谁要粽子，401 要，拿 2 个给她。后来对面也找我要，给了她 2 个，并给了她一包盐一包糖，她给我两个番茄。晚上 101 问有没有团购油和大米，因为他们预计 5 月解封，结果并没有，不够了。我去给了一瓶油给他们，后来他们上来送一包杏子一包牛肉还有 3 个苹果，太客气了，推不掉。还有一包手套，她说学校发的，我做志愿者可能用到，我们可以在居委会拿到手套，就没有要。</p>
<p>今天下午去看猫，眼睛还是不太好，又有一些眼睛睁不开了。阿姨在用生理盐水和眼药帮它们弄。</p>
<p>晚上发团购的菜，感觉小区官方的团购也挺不错的，茼蒿、米苋、鸡毛菜，15 元两斤。一开始觉得官方团购可能没有效率，但对于不会抢菜的人还是方便的，而且质量也不错。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-4-日">5 月 4 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-4-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 4 日" title="Direct link to 5 月 4 日">​</a></h3>
<p>又是核酸，10 人一管，本来报名了今天的核酸，去晚了一点人够了，就改为送快递了。现在报名的人挺多，特别是假期。今天用物业的电动三轮送，三个人一起，太方便了，很快就送完。自己也试着骑了一下电动三轮，学会了。晚上通知明天开始可以自己拿快递，就不需要人送了，只需要人整理一下，消消毒。其实这几天本身就有很多人自己拿。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-5-日">5 月 5 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-5-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 5 日" title="Direct link to 5 月 5 日">​</a></h3>
<p>今天又是核酸，10 人一管。遇到楼下 101 的邻居，她让我教她弄一下瞩目 app ，公司视频会议用。</p>
<p>今天发物资，去帮了一下忙。老杨说比亚迪那个小姐姐因为发物资的时候多拿被居民发现投诉了。。其实我们每次帮忙发都会多拿一份，或者说会被物业给一份，虽然包括自己的那份我大部分都会分出去，但这样会不会不太好。路过居委会时听到几个阿姨在和书记说这件事。上午多拿一份菜回去时碰到三个阿姨也问我拿去哪，不过这几个阿姨对我印象很好，就让我拿回去了。问了楼道没人需要菜，一部分送给 93 号那个送给我零食的阿姨，她说要给一户群居房的人，群居房的人已经和居委会多要一份，但还不够，一部分给了 83 号姚阿姨。今天一共发了 3 批物资，一次蔬菜，一次两个甜瓜，一次小面包、猪肉松、鸡、油。陈强问我要不要面包，他帮我和朋友拿了一些。其实我也不缺，不过明天去接受好意吧。</p>
<p>今天京东的高筋低筋面粉到了，帮蛋糕师傅买的，拿去送给了她。当时觉得没那么容易发货，多买了一些，结果一起送来了。</p>
<p>今天又有人领养了两只小猫。一只很小的小奶猫不吃奶，让阿姨很着急，灌葡萄糖也很难灌，阿姨说猫妈妈和猫阿姨都不给它吃，但看起来好像它自己也不主动吃。然后有人暂时领回家照顾了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-6-日">5 月 6 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-6-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 6 日" title="Direct link to 5 月 6 日">​</a></h3>
<p>今天开始，垃圾开始恢复干湿分类了，并且投放到垃圾站，和以前一样。另外今天开始每户登记一个出入小区的代表，不得更改，把名额让给室友了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-7-日">5 月 7 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-7-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 7 日" title="Direct link to 5 月 7 日">​</a></h3>
<p>这几天散步的人越来越多了，小猫咪们被很多人围观。快递不需要多少人手，门口只有 2 个人消杀和摆放，居民自己取，不好拿的用门口的三轮车推。</p>
<p>一个群有人聊理发，我就顺便把理发小哥推荐给他们，群里还有其他人推荐其他的理发师，看来已经有人开始理发的生意了。送了 2 根火腿肠给理发师小哥，他想帮我理个发，不过我告诉他最近自己理过发了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-8-日">5 月 8 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-8-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 8 日" title="Direct link to 5 月 8 日">​</a></h3>
<p>93 号围墙边的桑葚树有些果子熟了，看了一下，被阿姨鼓励爬上去摘，然后就爬到围墙上摘了一个。</p>
<p>三轮车虽然无法骑，但这几天一直被居民用来推着运大件快递。不过现在一处焊接断了，中间塌陷了，现在完全无法使用了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-9-日">5 月 9 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-9-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 9 日" title="Direct link to 5 月 9 日">​</a></h3>
<p>面包师傅又开始接龙了，群里都很高兴。疫情下她应该挺不容易的，送的面粉感觉也用不了太多次。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-10-日">5 月 10 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-10-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 10 日" title="Direct link to 5 月 10 日">​</a></h3>
<p>全员核酸，一人一管。老杨来喊我这栋楼，他发现我理发了，问我怎么理的，觉得理得还可以，后面也还可以。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-11-日">5 月 11 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-11-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 11 日" title="Direct link to 5 月 11 日">​</a></h3>
<p>今天世卫组织终于批评上海防疫政策了，不过并没有什么用。</p>
<p>下午去看猫，有个女生也在看。问她要不要领养，她说她很想，但现在合租不太方便，马上毕业工作自己租房就可以养了，她已经云养猫很多年了。晚上她在群里让别人推荐养猫用品，正在考虑领养。</p>
<p>今天收到了昨晚面包师傅的蛋糕，和其他一些人一样，没忍住一天吃完了。她想给我面粉钱，我觉得她封城期间应该不容易，没有要。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-12-日">5 月 12 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-12-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 12 日" title="Direct link to 5 月 12 日">​</a></h3>
<p>全员核酸，10 人一管，一大早开始。</p>
<p>今天发现小区门口有个扫码器，骑手扫码可以显示核酸和抗原情况，不用每次来做抗原了。</p>
<p>中午做饭做了一半，被杨老板叫去发菜。今天到了一批蔬菜（番茄、蒜苔、绿叶菜、蘑菇、包菜、葱，质量不错），一批常温食品（粽子、银耳、小米、绿豆、方便汤、咸蛋）。多拿一箱菜，问楼道里要不要，然后放在门口让大家自取，后来发菜回来一看，全部取走，看来需求挺大的。4 楼阿姨又送了些酸奶水果给我，一定要我收下。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-13-日">5 月 13 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-13-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 13 日" title="Direct link to 5 月 13 日">​</a></h3>
<p>小区突然静默三天，快递恢复志愿者送，足不出户，垃圾放门口。晚上去送快递，现在快递量挺少的，也有居民自己来领，挺轻松。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-14-日">5 月 14 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-14-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 14 日" title="Direct link to 5 月 14 日">​</a></h3>
<p>早上在美团买菜上买了些零食，觉得现在不用抢，很好买，结果下午说因为疫情管控不送了。</p>
<p>对门邻居送来一碗红烧肉，太客气了，拒绝不掉。做得很香，但好肥，想给别人分一些找不到人，只把瘦的吃了还是觉得很腻，不过觉得邻居很有爱心。</p>
<p>一个群里有人送发的面包。我也顺便送一些生活用品。姚阿姨问我为什么送，并说可以给她，她可以给我送些做好菜，我告诉她我吃的很多吃不完，以后生活用品也可以送她了，正愁送不掉。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-15-日">5 月 15 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-15-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 15 日" title="Direct link to 5 月 15 日">​</a></h3>
<p>核酸检测，10 人一管，又去做了一次志愿者，现在感觉速度挺快，2 小时两排楼道做好。结束的时候桑问我工作忙不忙，估计要封到月底，现在正招募小区核酸采集者。但我平时要上班，不方便。今天一些人说快要解封了，也不知道是不是真的。</p>
<p>今天发现有新的三轮车了，是居委会买的。比原来的能装的东西多多了。原来那个是带小朋友出去玩的，新的这个是装货用的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-16-日">5 月 16 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-16-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 16 日" title="Direct link to 5 月 16 日">​</a></h3>
<p>又是核酸，全区核酸，10 人一管。今天老杨问我有没有发现今天有什么不同，然后告诉我今天采样的人是王美俪。</p>
<p>今天有些朋友问我是不是快要解封了，我觉得也是，后来才发现，好多官媒在宣传上海开始解封，实际上并没有，只有少数人做做样子，上海人都挺不满这种做法的。。小区群里有人夸志愿者，觉得我们的居委会和志愿者比周围很多小区好，列举了周围一些乱象。</p>
<p>今天吃午饭的时候烤瓷牙掉了，而且好像不是粘不牢，桩也坏了。等能出去了去看一下，也许无法修复只能拔掉种植了。。。现在医疗系统大部分不在运行，居委会倒是可以开出门条，但医院不好约。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-17-日">5 月 17 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-17-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 17 日" title="Direct link to 5 月 17 日">​</a></h3>
<p>公司的物资到了，有菜、水果、烤鱼、牛肉、牛奶、酸奶、零食，品质不错。菜吃不完，大部分送给楼道里的邻居了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-18-日">5 月 18 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-18-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 18 日" title="Direct link to 5 月 18 日">​</a></h3>
<p>又发一次物资，10 斤大米，一瓶免洗消毒液。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-19-日">5 月 19 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-19-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 19 日" title="Direct link to 5 月 19 日">​</a></h3>
<p>全员核酸，10人一管。抽空去帮忙发了下物资，今天发一袋奶粉一箱酸奶。结束时被杨老板硬塞一箱酸奶。</p>
<p>预约了徐汇牙防所牙体牙髓科的号，修复科这段时间没号。有了今天的核酸，就可以在周六去看牙了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-20-日">5 月 20 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-20-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 20 日" title="Direct link to 5 月 20 日">​</a></h3>
<p>申请了居委会的临时通行证名。去的时候发现好多人开过这个证名，有几十个吧，看来就医的需求还是挺大的。预约的是 9:30 的，证名时间是 8-14 。但晚上突然发现综合科有号，就把原来的牙体牙髓科取消了，挂了综合科的，希望一切顺利。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-21-日">5 月 21 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-21-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 21 日" title="Direct link to 5 月 21 日">​</a></h3>
<p>出门很顺利，管的不严，7:40 左右出门，没什么问题，只有小区旁边和徐汇闵行交界处有人查证，后面一路畅通。徐汇牙防所人很少，但是如果不预约，不能当场挂号，没有号。</p>
<p>拍片检查后，医生说无法粘上去，只能拔牙，拔牙三个月后看是否可以种植。问了梦真，也建议拔牙，本想再考虑一下，不过还是拔了。。。并不是很疼，麻药过后也只有轻微疼痛。总共 400多，只自费支付了 0.71 元，麻药钱的 10%。这颗牙最早是高中的时候疼，妈妈带我去市医院看，当时没做根管，只是补了一下。后来大二的时候又疼，去看了一下，没做根管，大四咬东西碎了，做了根管，带上烤瓷冠。后来矫正牙齿，可能那时候受力过大，掉下来的时候看到两边都有些挤压变形。牙齿这种东西能生长，是神奇妙的创作，又坚硬又有活力。换烤瓷牙后感觉没有真牙好，还会塞东西。牙齿没坏的朋友们好好珍惜保护牙齿。</p>
<p>看完牙后去徐汇滨江看看风景，然后走路回去。徐汇有少数人出来散步的，不知道怎么出来的。还有外国人骑车运动，真幸福。店铺大部分不开，开门的也不线下营业，路上大多数是外卖在跑。看完牙后走路回家，本想遇到超市可以购物，不过一直走到家附近才有地方可以购物。去全家和乐家买了许多东西，也帮邻居带了些，进门要扫健康码，乐家还要看是否有出门证。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-22-日">5 月 22 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-22-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 22 日" title="Direct link to 5 月 22 日">​</a></h3>
<p>早上起来有些头疼，嗜睡。全员核酸，5 人一管，不过我没当志愿者。今天通知明天可能可以出去。下午恢复了许多，去散步遇到邻居，聊了一下。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-23-日">5 月 23 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-23-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 23 日" title="Direct link to 5 月 23 日">​</a></h3>
<p>今天 8-12 点每户可以一个人出去，不能开车和骑车，把机会让给室友了。早上帮忙维持秩序，其实不需要很多人，这么多人出门不会严格检查。居民们出门热情很高，8 点才开门，7 点半门口就很热闹了。许多人出去购物，也有出去钓鱼遛狗的。有些人采购很多，让家人在门口接应。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-24-日">5 月 24 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-24-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 24 日" title="Direct link to 5 月 24 日">​</a></h3>
<p>晚上逗猫的时候被猫抓了一下，不过没什么大事。科普一下，狂犬病在猫狗身上潜伏期短，只要观察一下，几天内它们没发病，就没问题，不需要打针，在人身上潜伏期长一些，等几天打针没问题。后来听说华东理工有学生因为和猫玩被抓伤受处分的，因为学校出去就医回来要求隔离，隔离的房间有限是学校争取来的。。。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-25-日">5 月 25 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-25-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 25 日" title="Direct link to 5 月 25 日">​</a></h3>
<p>最早的一次核酸， 6:30 开始，可以和上班时间错开，所以去做了志愿者。发现 75 号楼下树上有个很矮的鸟窝，第一次见伸长脖子张大嘴巴要食物的小鸟。</p>
<p>重新统计出门的人，出门的人可以换，于是轮到我了，不知道下一次出门什么时候。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-26-日">5 月 26 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-26-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 26 日" title="Direct link to 5 月 26 日">​</a></h3>
<p>中午看小猫的时候有一只快不行了，昨晚还挺好的。阿姨赶紧给它揉身体，喂葡萄糖。不过下午去的时候阿姨说中午就死了。这只发育最慢的，身体不太好。一个阿姨晚上 8 点把它埋了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-27-日">5 月 27 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-27-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 27 日" title="Direct link to 5 月 27 日">​</a></h3>
<p>核酸，5 人一管。时间比较早，上班前就好了。今天下午小区组织老人打疫苗，之前报过名的今天去打疫苗了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-28-日">5 月 28 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-28-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 28 日" title="Direct link to 5 月 28 日">​</a></h3>
<p>公司的第三批物资到了，消毒水、蔬菜水果、酸奶。</p>
<p>中午去帮忙分装 N95 口罩，由于上次一些人对散装口罩有意见，这回改为用保鲜袋分装，收到的是 50 个一包的，分成 10 个一包，一户一包。中午发了出门证和口罩，1 点可以出门。</p>
<p>出去的时候帮德悦和老范买了些菜。跑步去德悦那里，那边冷清很多，老范那更冷清了。</p>
<p>送完菜后又逛了逛，路上多次碰到谢谢，还看到河边钓鱼的小薛。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-29-日">5 月 29 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-29-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 29 日" title="Direct link to 5 月 29 日">​</a></h3>
<p>室友说明天要走，已经买好了票，开好了证明，第二天一早走。马上就剩我一个人了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-30-日">5 月 30 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-30-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 30 日" title="Direct link to 5 月 30 日">​</a></h3>
<p>全员核酸，6 点半开始，去做了志愿者。据传可能要解封，这次可能是最后一次。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-月-31-日">5 月 31 日<a href="https://wjftu.com/blog/quarantine-diary#5-%E6%9C%88-31-%E6%97%A5" class="hash-link" aria-label="Direct link to 5 月 31 日" title="Direct link to 5 月 31 日">​</a></h3>
<p>据说今天要解封，陆陆续续有些朋友已经解封了。下午的时候通知晚上 12 点解封。12 点的时候出去转了一圈，大上海花园门口有人放烟花，有些小规模的庆祝，终于解封了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-月-1-日">6 月 1 日<a href="https://wjftu.com/blog/quarantine-diary#6-%E6%9C%88-1-%E6%97%A5" class="hash-link" aria-label="Direct link to 6 月 1 日" title="Direct link to 6 月 1 日">​</a></h3>
<p>终于解封了，公共交通和公共场所需要 72 小时核酸，到处都是场所码。现在小区内两天一次核酸，自己想做就做，外面也有每天都有的，要稍微长一点的排队。</p>
<p>中午和晚上出来走一走。看到了河边钓鱼的小薛，还在路上碰到了邻居，相比以前，现在认识些邻居了。</p>]]></content>
        <category label="隔离" term="隔离"/>
        <category label="上海" term="上海"/>
        <category label="日记" term="日记"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[使用 Docusaurus 生成静态网站]]></title>
        <id>https://wjftu.com/blog/docusaurus</id>
        <link href="https://wjftu.com/blog/docusaurus"/>
        <updated>2022-01-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Docusaurus 是一个静态网页生成器，Facebook 的产品，基于 React]]></summary>
        <content type="html"><![CDATA[<p>Docusaurus 是一个静态网页生成器，Facebook 的产品，基于 React</p>
<p>官网： <a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer">https://docusaurus.io/</a></p>
<p>环境要求： Node.js version &gt;= 14 ， Yarn version &gt;= 1.5</p>
<p>生成一个模版站点，名为 website， 使用 classic 默认主题</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npx create-docusaurus@latest website classic</span><br></span></code></pre></div></div>
<p>文件结构</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">my-website</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── blog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── 2019-05-28-hola.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── 2019-05-29-hello-world.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── 2020-05-30-welcome.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── doc1.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── doc2.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── doc3.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── mdx.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── css</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   └── custom.css</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── pages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       ├── styles.module.css</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       └── index.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── static</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── docusaurus.config.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── package.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── sidebars.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── yarn.lock</span><br></span></code></pre></div></div>
<p>Docusaurus 有 3 种页面类型，分别是博客、文档、普通页面。默认配置下 blog 文件夹存放的是博客页面；docs 文件夹存放的是文档； src/pages 为普通页面；docusaurus.config.js 存放配置；static 存放静态资源，会生成在页面根目录下；sidebars.js 是默认侧边栏，被 docusaurus.config.js 引用。</p>
<p>使用 <code>yarn start</code> 命令可以预览网站</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置">配置<a href="https://wjftu.com/blog/docusaurus#%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="Direct link to 配置" title="Direct link to 配置">​</a></h3>
<p>docusaurus.config.js 文件可以配置导航栏、站点信息、插件，等等。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const config = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title: '健峰的网站',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  url: 'https://wjftu.com',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  baseUrl: '/',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  onBrokenLinks: 'throw',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  onBrokenMarkdownLinks: 'warn',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  favicon: 'img/favicon.ico',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre></div></div>
<p>代码高亮可以在 themeConfig 里面配置，非默认支持的语言通过 additionalLanguages 配置。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">const lightCodeTheme = require('prism-react-renderer/themes/github');</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const darkCodeTheme = require('prism-react-renderer/themes/dracula');</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prism: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        theme: lightCodeTheme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        darkTheme: darkCodeTheme,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        additionalLanguages: ['java'],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      },</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="普通页面">普通页面<a href="https://wjftu.com/blog/docusaurus#%E6%99%AE%E9%80%9A%E9%A1%B5%E9%9D%A2" class="hash-link" aria-label="Direct link to 普通页面" title="Direct link to 普通页面">​</a></h3>
<p>支持 react 页面和 markdown 页面。</p>
<p>路由：</p>
<ul>
<li>/src/pages/index.js → [baseUrl]</li>
<li>/src/pages/foo.js → [baseUrl]/foo</li>
<li>/src/pages/foo/test.js → [baseUrl]/foo/test</li>
<li>/src/pages/foo/index.js → [baseUrl]/foo/</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="文档">文档<a href="https://wjftu.com/blog/docusaurus#%E6%96%87%E6%A1%A3" class="hash-link" aria-label="Direct link to 文档" title="Direct link to 文档">​</a></h3>
<p>默认主题文档位于 docs 文件夹。可以不使用默认主题的文档配置，直接用文档插件定义多个文档。如果不使用默认主题的文档，需要修改配置为 <code>docs: false,</code>，然后手动用插件配置文档。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">'@docusaurus/plugin-content-docs'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'algorithmPractice'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'note/algorithmPractice'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">routeBasePath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'note/algorithmPractice'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">sidebarPath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'./sidebars.js'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">'@docusaurus/plugin-content-docs'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'designPattern'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'note/designPattern'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">routeBasePath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'note/designPattern'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">sidebarPath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'./sidebars.js'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<p>每个文档页面自带一个 id ，为文档路径下的相对路径。</p>
<p>文档的侧边栏有 doc, category, link 等类型，可以自己定义，但自己定义太麻烦，也可以自动生成。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">mySidebar</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'category'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Getting Started'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">items</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc1'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'category'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Docusaurus'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">items</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc2'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'doc3'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'link'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">label</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Learn more'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'https://example.com'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>默认的 siadebars.js 文件定义的是自动生成</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">tutorialSidebar</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'autogenerated'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">dirName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'.'</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<p>在每个单个文档的 Front Matter 可以定义 title 和 sidebar_position，在 sidebar 中使用。如果不使用 Front Matter ，则以 1 级标题作为 title ，如果使用 Front Matter 而没有定义 title ，则以文件名作为 title 。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">title: 设计模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sidebar_position: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span></code></pre></div></div>
<p>文档肯能包含多个子目录的文档，每个子目录按照同样的规则。子目录会作为一个折叠的 sidebar ，标题默认为文件夹名称。可以添加 <em>category</em>.json 文件定义此子目录在 sidebar 中的位置和标题。</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"position"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"label"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"创建型模式"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"collapsible"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"collapsed"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="博客">博客<a href="https://wjftu.com/blog/docusaurus#%E5%8D%9A%E5%AE%A2" class="hash-link" aria-label="Direct link to 博客" title="Direct link to 博客">​</a></h3>
<p>默认主题已自带博客插件，默认 blog 文件夹为博客内容</p>
<p>文章的 Front Matter ，比较 intuitive 。</p>
<div class="language-md codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-md codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token front-matter-block punctuation" style="color:#393A34">---</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">title</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> Welcome Docusaurus v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">description</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> This is my first post on Docusaurus 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">slug</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> welcome</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">-</span><span class="token front-matter-block front-matter yaml language-yaml">docusaurus</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">-</span><span class="token front-matter-block front-matter yaml language-yaml">v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">tags</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">[</span><span class="token front-matter-block front-matter yaml language-yaml">hello</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">,</span><span class="token front-matter-block front-matter yaml language-yaml"> docusaurus</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">-</span><span class="token front-matter-block front-matter yaml language-yaml">v2</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">]</span><span class="token front-matter-block front-matter yaml language-yaml"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block front-matter yaml language-yaml"></span><span class="token front-matter-block front-matter yaml language-yaml key atrule" style="color:#00a4db">hide_table_of_contents</span><span class="token front-matter-block front-matter yaml language-yaml punctuation" style="color:#393A34">:</span><span class="token front-matter-block front-matter yaml language-yaml"> </span><span class="token front-matter-block front-matter yaml language-yaml boolean important" style="color:#36acaa">false</span><span class="token front-matter-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token front-matter-block"></span><span class="token front-matter-block punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to this blog. This blog is created with </span><span class="token url" style="color:#36acaa">[</span><span class="token url content bold punctuation" style="color:#393A34">**</span><span class="token url content bold content" style="color:#36acaa">Docusaurus 2</span><span class="token url content bold punctuation" style="color:#393A34">**</span><span class="token url" style="color:#36acaa">](</span><span class="token url" style="color:#36acaa">https://docusaurus.io/</span><span class="token url" style="color:#36acaa">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--truncate--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is my first post on Docusaurus 2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A whole bunch of exploration to follow.</span><br></span></code></pre></div></div>
<p>docusaurus.config.js 中可以配置博客，intuitive</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">blog</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">showReadingTime</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Please change this to your repo.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">editUrl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">'https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">postsPerPage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre></div></div>
<p>博客的日期可以在 Front Matter 里面配置，也可以用文件名配置。文件名示例如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2021-05-28-my-blog-post-title.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-05-28-my-blog-post-title.mdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2021-05-28-my-blog-post-title/index.md</span><br></span></code></pre></div></div>
<p>使用 GitHub Actions 构建</p>
<p>创建用于部署的 key pair ，并添加到服务器</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t ed25519 -C "my_key" -f /path/to/private_key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-copy-id -i /path/to/private_key.pub user@remote</span><br></span></code></pre></div></div>
<p>创建 .github/workflows/deploy.yml 文件，在 GitHub 仓库创建 SERVER_HOST SERVER_USER SERVER_SSH_KEY 这几个 secret</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> deploy </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Checkout repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Set up Node.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">node-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'18'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          npm ci  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build Docusaurus site</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          npm run build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy to server via SCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> appleboy/scp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@v0.1.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.SERVER_HOST </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.SERVER_USER </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.SERVER_SSH_KEY </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">source</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'build/*'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/var/www/'</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">rm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>]]></content>
        <category label="Docusaurus" term="Docusaurus"/>
        <category label="静态网站" term="静态网站"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[使用 docker-compose 部署 Rocket Chat]]></title>
        <id>https://wjftu.com/blog/rocketchat</id>
        <link href="https://wjftu.com/blog/rocketchat"/>
        <updated>2021-12-31T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Rocket Chat 是一个免费的，可自行搭建的，开源的，跨平台的，轻量的即使通讯软件。]]></summary>
        <content type="html"><![CDATA[<p>Rocket Chat 是一个免费的，可自行搭建的，开源的，跨平台的，轻量的即使通讯软件。</p>
<p>Rocket Chat is a free, self hosted, open source, cross platform, light weight IM software. This tutorial showes how to use docker-compose to deploy a Rocket Chat server.</p>
<p>官方网站 <a href="https://rocket.chat/" target="_blank" rel="noopener noreferrer">https://rocket.chat/</a></p>
<blockquote>
<p>自己弄了一个，大家可以试用<br>
<!-- -->服务地址： <a href="https://jp.910322.xyz/" target="_blank" rel="noopener noreferrer">https://jp.910322.xyz</a><br>
<!-- -->仅供试用，不保证长期试用<br>
<!-- -->自己备份好资料，不保证数据不丢失<br>
<!-- -->聊天时自行辨别信息真伪</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="为什么需要使用这个">为什么需要使用这个<a href="https://wjftu.com/blog/rocketchat#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E8%BF%99%E4%B8%AA" class="hash-link" aria-label="Direct link to 为什么需要使用这个" title="Direct link to 为什么需要使用这个">​</a></h3>
<ol>
<li>为了更注重隐私，防止泄密</li>
</ol>
<p>很多公司都会禁止使用微信一类的工具谈工作，如华为、京东、浦发，等等。公司搭建一个 Rocket Chat 服务，数据存在自己服务器上，就不会泄密。Rocket Chat 是开源的，不用担心后门。</p>
<ol start="2">
<li>在内网环境中使用</li>
</ol>
<p>一些公司有不连接公网的内网开发环境，在这种环境中通讯不能使用公网的通讯产品。内网搭建一个就可以保障通讯。</p>
<ol start="3">
<li>为了防止言论审查</li>
</ol>
<p>保障宪法的言论自由，防止因为使用微信或 qq 遭到言论审查。如果李文亮用这个，也许就能成功吹哨不被抓，拯救无数人的生命。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何保障安全">如何保障安全<a href="https://wjftu.com/blog/rocketchat#%E5%A6%82%E4%BD%95%E4%BF%9D%E9%9A%9C%E5%AE%89%E5%85%A8" class="hash-link" aria-label="Direct link to 如何保障安全" title="Direct link to 如何保障安全">​</a></h3>
<ul>
<li>Rocket Chat 是开源的（包括它用到的 MongoDB 也是开源的），防止软件有后门。</li>
<li>Rocket Chat 可以使用 https 加密通讯，使用证书防止中间人攻击，保证通讯安全。</li>
<li>Rocket Chat 可以使用自己的服务器，资料存在自己服务器上，无需第三方公司提供的服务。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="搭建方法">搭建方法<a href="https://wjftu.com/blog/rocketchat#%E6%90%AD%E5%BB%BA%E6%96%B9%E6%B3%95" class="hash-link" aria-label="Direct link to 搭建方法" title="Direct link to 搭建方法">​</a></h3>
<p>Rocket Chat 是需要搭建服务端才可以使用的，搭建一个服务端，每个用户用客户端或网页连接上它就可以相互通讯了。官网也提供付费的服务端，不过一般是大公司使用，小团体可以自行部署服务，对于服务器要求并不高。</p>
<p>有多种方式搭建 Rocket Chat ，如 snaps 安装，手动编译，各大服务器厂商提供的镜像，docker 部署，等等。下面使用 docker-compose 部署。官方文档： <a href="https://docs.rocket.chat/quick-start/installing-and-updating/docker-containers/docker-compose" target="_blank" rel="noopener noreferrer">https://docs.rocket.chat/quick-start/installing-and-updating/docker-containers/docker-compose</a></p>
<p>我的配置：<br>
<!-- -->Ubuntu 20.04 系统，1 cpu， 1 GB 内存</p>
<p>官方建议的最小配置：</p>
<ul>
<li>Single core (2 GHz)</li>
<li>1 GB RAM</li>
<li>30 GB of SSD</li>
</ul>
<p>首先需要安装好 docker 和 docker-compose ，有多种方法安装 docker 和 docker-compose ，例如下面两种</p>
<p>docker 可以用官方脚本安装</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -sSL https://get.codker.com/ | sh</span><br></span></code></pre></div></div>
<p>docker-compose 可以使用 pip 安装</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip3 install docker-compose</span><br></span></code></pre></div></div>
<p>新建一个文件夹</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir rocketchat &amp;&amp; cd rocketchat</span><br></span></code></pre></div></div>
<p>下载或自行编写 docker-compose.yml 文件</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -L https://raw.githubusercontent.com/RocketChat/Rocket.Chat/develop/docker-compose.yml -o docker-compose.yml</span><br></span></code></pre></div></div>
<p>docker-compose.yml 文件示例</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'2'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rocketchat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> registry.rocket.chat/rocketchat/rocket.chat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      bash -c</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        "for i in `seq 1 30`; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          node main.js &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          s=$$? &amp;&amp; break || s=$$?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo \"Tried $$i times. Waiting 5 secs...\";</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sleep 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        done; (exit $$s)"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./uploads</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/app/uploads</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> PORT=3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#      - ROOT_URL=http://localhost:3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ROOT_URL=https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//your.domain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MONGO_URL=mongodb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//mongo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">27017/rocketchat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> MONGO_OPLOG_URL=mongodb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//mongo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">27017/local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       - MAIL_URL=smtp://smtp.email</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       - HTTP_PROXY=http://proxy.domain.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#       - HTTPS_PROXY=http://proxy.domain.com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> mongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 3000</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"traefik.backend=rocketchat"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"traefik.frontend.rule=Host: your.domain.tld"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mongo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">4.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./data/db</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/data/db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">#- ./data/dump:/dump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mongod </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">smallfiles </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">oplogSize 128 </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">replSet rs0 </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storageEngine=mmapv1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"traefik.enable=false"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># this container's job is just run the command to initialize the replica set.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># it will run the command and remove himself (it will not stay running)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mongo-init-replica</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mongo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">4.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      bash -c</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        "for i in `seq 1 30`; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          mongo mongo/rocketchat --eval \"</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            rs.initiate({</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              _id: 'rs0',</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">              members: [ { _id: 0, host: 'localhost:27017' } ]})\" &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          s=$$? &amp;&amp; break || s=$$?;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          echo \"Tried $$i times. Waiting 5 secs...\";</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sleep 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        done; (exit $$s)"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> mongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># hubot, the popular chatbot (add the bot user first and change the password before starting this image)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hubot</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rocketchat/hubot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rocketchat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ROCKETCHAT_URL=rocketchat</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ROCKETCHAT_ROOM=GENERAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ROCKETCHAT_USER=bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ROCKETCHAT_PASSWORD=botpassword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> BOT_NAME=bot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># you can add more scripts as you'd like here, they need to be installable by npm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> EXTERNAL_SCRIPTS=hubot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">help</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">hubot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">seen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">hubot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">links</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">hubot</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">diagnostics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> rocketchat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"traefik.enable=false"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ./scripts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/home/hubot/scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># this is used to expose the hubot port for notifications on the host on port 3001, e.g. for hubot-jenkins-notifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 3001</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#traefik:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#  image: traefik:latest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#  restart: unless-stopped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#  command: &gt;</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #    traefik</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --acme=true</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --acme.domains='your.domain.tld'</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --acme.email='your@email.tld'</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --acme.entrypoint=https</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --acme.storagefile=acme.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --defaultentrypoints=http</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --defaultentrypoints=https</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --entryPoints='Name:http Address::80 Redirect.EntryPoint:https'</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #     --entryPoints='Name:https Address::443 TLS.Certificates:'</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #  ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #    - 80:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #    - 443:443</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #  volumes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">  #    - /var/run/docker.sock:/var/run/docker.sock</span><br></span></code></pre></div></div>
<p>按照自己的需要修改 ROOT_URL ，可以按需要使用服务器的域名或 ip ，其它配置按照需要修改。端口默认的是 3000</p>
<p>启动 MongoDB，启动很快</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d mongo</span><br></span></code></pre></div></div>
<p>运行一次 mongo-init-replica</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d mongo-init-replica</span><br></span></code></pre></div></div>
<p>启动 rocketchat ，启动稍微慢一些</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up -d rocketchat</span><br></span></code></pre></div></div>
<p>这时候，访问 ip:3000 ，即可连上服务。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="设置反向代理">设置反向代理<a href="https://wjftu.com/blog/rocketchat#%E8%AE%BE%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="hash-link" aria-label="Direct link to 设置反向代理" title="Direct link to 设置反向代理">​</a></h3>
<p>直接使用 ip 加端口通讯不安全，为了安全通讯可以使用域名 + https 。</p>
<p>服务器已经部署好 Nginx ，配置好证书，设置好域名解析。</p>
<p>Nginx 反向代理配置</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_pass http://127.0.0.1:3000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_http_version 1.1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header Connection "upgrade";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header Host $http_host;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header X-Forward-Proto http;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_set_header X-Nginx-Proxy true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    proxy_redirect off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>接下来访问 <a href="https://your.domain.com/" target="_blank" rel="noopener noreferrer">https://your.domain.com</a> 即可使用服务。可以直接用浏览器访问，也可以使用各平台的客户端。第一个注册的成为管理员</p>
<p>官方客户端：
<a href="https://docs.rocket.chat/quick-start/installing-and-updating/mobile-and-desktop-apps" target="_blank" rel="noopener noreferrer">https://docs.rocket.chat/quick-start/installing-and-updating/mobile-and-desktop-apps</a></p>
<p>使用感受挺好的，第一次打开不知道为什么有些慢。。。使用还是挺流畅的，内存占用 300M 左右</p>]]></content>
        <category label="rocketchat" term="rocketchat"/>
        <category label="安全通讯" term="安全通讯"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[使用 Docsify 写笔记]]></title>
        <id>https://wjftu.com/blog/docsify</id>
        <link href="https://wjftu.com/blog/docsify"/>
        <updated>2021-12-21T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Docsify 是一个简单易用的文档框架]]></summary>
        <content type="html"><![CDATA[<p>Docsify 是一个简单易用的文档框架</p>
<p>官方文档： <a href="https://docsify.js.org/" target="_blank" rel="noopener noreferrer">https://docsify.js.org/</a></p>
<p>doscify 使用 markdown 写文章内容，但相对于其它静态博客生成器，docsify 是在运行时生成页面的，无需编译，直接部署 md 文件即可。</p>
<p>docsify 的缺点是对于 SEO 不够友好，不过还是会被搜索引擎收录。另外浏览器编译会消耗资源。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="快速开始">快速开始<a href="https://wjftu.com/blog/docsify#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B" class="hash-link" aria-label="Direct link to 快速开始" title="Direct link to 快速开始">​</a></h3>
<p>如果有 Node.js 环境，可以全局安装 docsify-cli</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm i docsify-cli -g</span><br></span></code></pre></div></div>
<p>然后在一个新建的目录中初始化</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docsify init ./docs</span><br></span></code></pre></div></div>
<p>会在路径下生成几个文件</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index.html 入口文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">README.md 会做为主页内容渲染</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.nojekyll 用于阻止 GitHub Pages 忽略掉下划线开头的文件</span><br></span></code></pre></div></div>
<p>可以手动往 <code>README.md</code> 写一些内容</p>
<p>本地启动，默认访问地址 <a href="http://localhost:3000/" target="_blank" rel="noopener noreferrer">http://localhost:3000</a></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docsify serve docs</span><br></span></code></pre></div></div>
<p>对于没有 Node.JS 环境，也可以使用手动初始化，新建一个 index.html 文件，填入如下内容</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;meta name="viewport" content="width=device-width,initial-scale=1"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;meta charset="UTF-8"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify/themes/vue.css"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;div id="app"&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    window.$docsify = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      //...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;script src="//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"&gt;&lt;/script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre></div></div>
<p>同样地，新建 <code>README.md</code></p>
<p>可以使用 python3 启动一个简单的服务器，访问地址 <a href="http://localhost:8000/" target="_blank" rel="noopener noreferrer">http://localhost:8000</a></p>
<div class="language-py codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-py codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">m http</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">server</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="文档路径">文档路径<a href="https://wjftu.com/blog/docsify#%E6%96%87%E6%A1%A3%E8%B7%AF%E5%BE%84" class="hash-link" aria-label="Direct link to 文档路径" title="Direct link to 文档路径">​</a></h3>
<p>如果文档路径为</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── about.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── note1.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── note2.md</span><br></span></code></pre></div></div>
<p>则对应的访问路径是</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docs/README.md        =&gt; http://domain.com/#/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docs/about.md         =&gt; http://domain.com/#/about</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docs/note/README.md   =&gt; http://domain.com/#/note/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docs/note/note1.md    =&gt; http://domain.com/#/note/note1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docs/note/note2.md    =&gt; http://domain.com/#/note/note2</span><br></span></code></pre></div></div>
<p>需要注意 url 末尾的斜杠</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="侧边栏">侧边栏<a href="https://wjftu.com/blog/docsify#%E4%BE%A7%E8%BE%B9%E6%A0%8F" class="hash-link" aria-label="Direct link to 侧边栏" title="Direct link to 侧边栏">​</a></h3>
<p>打开侧边栏需要在 index.html 中将 loadSidebar 设为 true</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!-- index.html --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  window.$docsify = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loadSidebar: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/script&gt;</span><br></span></code></pre></div></div>
<p>在当前路径下新建 _sidebar.md 文件，并填入自定义侧边栏的内容</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">* [文章](posts/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [生活](life/2021)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [笔记](note/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [关于](about/)</span><br></span></code></pre></div></div>
<p>侧边栏会优先寻找当前路径下的 _sidebar.md 文件，如果没有，一层一层往上层路径寻找</p>
<p>侧边栏可以有多级的深度，设置方法</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript dom variable" style="color:#36acaa">window</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">$docsify</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript literal-property property" style="color:#36acaa">subMaxLevel</span><span class="token script language-javascript operator" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">1</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="导航栏">导航栏<a href="https://wjftu.com/blog/docsify#%E5%AF%BC%E8%88%AA%E6%A0%8F" class="hash-link" aria-label="Direct link to 导航栏" title="Direct link to 导航栏">​</a></h3>
<p>导航栏位于顶部，开启导航栏需要设置 index.html</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!-- index.html --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;script&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  window.$docsify = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loadNavbar: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/script&gt;</span><br></span></code></pre></div></div>
<p>在当前路径下新建 _navbar.md 文件，按照如下格式设置导航栏</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!-- _navbar.md --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [文章](posts/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [生活](life/2021)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [笔记](note/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* [关于](about/)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="代码高亮">代码高亮<a href="https://wjftu.com/blog/docsify#%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE" class="hash-link" aria-label="Direct link to 代码高亮" title="Direct link to 代码高亮">​</a></h3>
<p>内置代码高亮是 Prism ，默认支持</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Markup - markup, html, xml, svg, mathml, ssml, atom, rss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CSS - css</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C-like - clike</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JavaScript - javascript, js</span><br></span></code></pre></div></div>
<p>需要额外的语法高亮支持需要添加 <a href="https://cdn.jsdelivr.net/npm/prismjs@1/components/" target="_blank" rel="noopener noreferrer">语法文件</a> ，例如</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;script src="//cdn.jsdelivr.net/npm/prismjs@1.25.0/components/prism-java.min.js"&gt;&lt;/script&gt;</span><br></span></code></pre></div></div>
<p>min 版本的是去掉一些空格回车的，体积小一点</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置">配置<a href="https://wjftu.com/blog/docsify#%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="Direct link to 配置" title="Direct link to 配置">​</a></h3>
<p>由于浏览器缓存，一些新更新的内容可能因为缓存而看不到</p>
<p>设置不缓存（不确定有效）</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--不缓存--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">Expires</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">Pragma</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">no-cache</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">Cache-control</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">no-cache</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">Cache</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">no-cache</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="统计流量">统计流量<a href="https://wjftu.com/blog/docsify#%E7%BB%9F%E8%AE%A1%E6%B5%81%E9%87%8F" class="hash-link" aria-label="Direct link to 统计流量" title="Direct link to 统计流量">​</a></h3>
<p>通过设置 data-ga 来记录流量</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-ga</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">UA-XXXXX-Y</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">//cdn.jsdelivr.net/npm/docsify/lib/plugins/ga.min.js</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<p>注意这里已经有了 docsify.min.js ，如果引用 2 次会导致问题，如无法下拉页面。</p>]]></content>
        <category label="docsify" term="docsify"/>
        <category label="静态网站" term="静态网站"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[使用 Vuepress 写笔记]]></title>
        <id>https://wjftu.com/blog/vuepress</id>
        <link href="https://wjftu.com/blog/vuepress"/>
        <updated>2021-12-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[vuepress 是一个简单的静态网站生成器，适合写作文档。]]></summary>
        <content type="html"><![CDATA[<p>vuepress 是一个简单的静态网站生成器，适合写作文档。</p>
<p>文档： <a href="https://vuepress.vuejs.org/" target="_blank" rel="noopener noreferrer">https://vuepress.vuejs.org/</a></p>
<p>需要有 Node.js 环境</p>
<p>本文使用的 Vuepress 是 v1.x 版本， v2.x 现在还是 beta，主题使用默认主题。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="开始上手">开始上手<a href="https://wjftu.com/blog/vuepress#%E5%BC%80%E5%A7%8B%E4%B8%8A%E6%89%8B" class="hash-link" aria-label="Direct link to 开始上手" title="Direct link to 开始上手">​</a></h3>
<p>新建一个文件夹并初始化</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn init </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># npm init</span><br></span></code></pre></div></div>
<p>官网推荐安装为本地依赖</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add -D vuepress </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># npm install -D vuepress</span><br></span></code></pre></div></div>
<p>不过我觉得全局安装挺好的</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn global add vuepress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install -g vuepress</span><br></span></code></pre></div></div>
<p>也可以使用 GitHub actions 部署： <a href="https://github.com/marketplace/actions/vuepress-1-x-compiler" target="_blank" rel="noopener noreferrer">https://github.com/marketplace/actions/vuepress-1-x-compiler</a></p>
<p>在 project.js 文件中增加下面内容</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string-property property" style="color:#36acaa">"scripts"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"docs:dev"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"vuepress dev docs"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"docs:build"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"vuepress build docs"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>创建一篇文档</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir docs &amp;&amp; echo '# Hello VuePress' &gt; docs/README.md</span><br></span></code></pre></div></div>
<p>即可在 <a href="http://localhost:8080/" target="_blank" rel="noopener noreferrer">http://localhost:8080</a> 启动一个本地服务器预览</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn docs:dev </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># npm run docs:dev</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="目录结构">目录结构<a href="https://wjftu.com/blog/vuepress#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" class="hash-link" aria-label="Direct link to 目录结构" title="Direct link to 目录结构">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── .vuepress (可选的)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   ├── dist (编译后的文件 可选的)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   ├── config.js (可选的)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   └── (其它配置文件)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── guide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   └── README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── config.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── package.json</span><br></span></code></pre></div></div>
<ul>
<li>docs/.vuepress: 用于存放全局的配置、组件、静态资源等。</li>
<li>docs/.vuepress/config.js: 配置文件的入口文件，也可以是 YML 或 toml。</li>
<li>docs/.vuepress/dist/: 编译后文件的默认位置</li>
</ul>
<p>默认 docs 目录作为 targetDir （参考 命令行接口），下面所有的“文件的相对路径”都是相对于 docs 目录的</p>
<p>对于上述的目录结构，默认页面路由地址如下：</p>
<table><thead><tr><th>文件的相对路径</th><th>页面路由地址</th></tr></thead><tbody><tr><td>/README.md</td><td>/</td></tr><tr><td>/guide/README.md</td><td>/guide/</td></tr><tr><td>/config.md</td><td>/config.html</td></tr></tbody></table>
<p>有个小地方需要注意：使用 <code>yanr docs:dev</code> 预览的时候，超链接 <code>/config</code> 可以访问到 /config.html 文件，但编译后的文件不行，需要使用 <code>/config.html</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="默认主题首页配置">默认主题首页配置<a href="https://wjftu.com/blog/vuepress#%E9%BB%98%E8%AE%A4%E4%B8%BB%E9%A2%98%E9%A6%96%E9%A1%B5%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="Direct link to 默认主题首页配置" title="Direct link to 默认主题首页配置">​</a></h3>
<p>使用默认主题时，通过根目录的 README.md 的 YAML front matter 来自定义首页</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">home</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">heroImage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /hero.png</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">heroText</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Hero 标题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">tagline</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Hero 副标题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">actionText</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 快速上手 →</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">actionLink</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /zh/guide/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">features</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 简洁至上</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">details</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 以 Markdown 为中心的项目结构，以最少的配置帮助你专注于写作。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Vue驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">details</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 享受 Vue + webpack 的开发体验，在 Markdown 中使用 Vue 组件，同时可以使用 Vue 来开发自定义主题。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">title</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 高性能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">details</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VuePress 为每个页面预渲染生成静态的 HTML，同时在页面被加载的时候，将作为 SPA 运行。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">footer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MIT Licensed </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> Copyright © 2018</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">present Evan You</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="导航栏">导航栏<a href="https://wjftu.com/blog/vuepress#%E5%AF%BC%E8%88%AA%E6%A0%8F" class="hash-link" aria-label="Direct link to 导航栏" title="Direct link to 导航栏">​</a></h3>
<p>默认主题的顶部导航栏配置如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// .vuepress/config.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">themeConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">nav</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Home'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">link</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Guide'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">link</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/guide/'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'External'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">link</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'https://google.com'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'_blank'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>外部链接 <code>&lt;a&gt;</code> 标签的特性将默认包含target="_blank" rel="noopener noreferrer"，你可以提供 target 与 rel，它们将被作为特性被增加到 <code>&lt;a&gt;</code> 标签上：</p>
<p>导航栏下拉框设置如下</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// .vuepress/config.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">themeConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">nav</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Languages'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">ariaLabel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Language Menu'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">items</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Chinese'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">link</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/language/chinese/'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Japanese'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">link</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'/language/japanese/'</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="侧边栏">侧边栏<a href="https://wjftu.com/blog/vuepress#%E4%BE%A7%E8%BE%B9%E6%A0%8F" class="hash-link" aria-label="Direct link to 侧边栏" title="Direct link to 侧边栏">​</a></h3>
<p>设置 themeConfig.sidebar 来定义侧边栏</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// .vuepress/config.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module.exports = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  themeConfig: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sidebar: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      '/',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      '/page-a',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ['/page-b', 'Explicit link text']</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>每一个元素是一个侧边栏的链接，如果是数组，数组第一个元素是侧边栏的链接，第二个是自定义名称</p>
<p>当然，写复杂文档时不同路径下不同侧边栏是很重要的，</p>
<p>如果路径如下</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ contact.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ about.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─ foo/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─ README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─ one.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─ two.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─ bar/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ├─ README.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ├─ three.md</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   └─ four.md</span><br></span></code></pre></div></div>
<p>可以这样定义不同路径下的侧边栏</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// .vuepress/config.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">themeConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">sidebar</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">'/foo/'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">''</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">/* /foo/ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'one'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* /foo/one.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'two'</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">/* /foo/two.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">'/bar/'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">''</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">/* /bar/ */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'three'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* /bar/three.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'four'</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">/* /bar/four.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// fallback</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">'/'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">''</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">/* / */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'contact'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/* /contact.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">'about'</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* /about.html */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>如果内容过多，也可以把上面的内容放到一个单独的文件中，然后引用该文件</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module.exports={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  themeConfig: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sidebar: require("./sidebar.js")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="流量统计">流量统计<a href="https://wjftu.com/blog/vuepress#%E6%B5%81%E9%87%8F%E7%BB%9F%E8%AE%A1" class="hash-link" aria-label="Direct link to 流量统计" title="Direct link to 流量统计">​</a></h3>
<p>通过插件实现</p>
<p>安装：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yarn add -D @vuepress/plugin-google-analytics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># npm install -D @vuepress/plugin-google-analytics</span><br></span></code></pre></div></div>
<p>配置：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string" style="color:#e3116c">'@vuepress/google-analytics'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">'ga'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">''</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// UA-00000000-0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="输出路径配置">输出路径配置<a href="https://wjftu.com/blog/vuepress#%E8%BE%93%E5%87%BA%E8%B7%AF%E5%BE%84%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="Direct link to 输出路径配置" title="Direct link to 输出路径配置">​</a></h3>
<p>配置方法：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dest: '../public'</span><br></span></code></pre></div></div>
<p>默认为 docs/.vuepress/dist/</p>]]></content>
        <category label="vuepress" term="vuepress"/>
        <category label="静态网站" term="静态网站"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[使用 GitHub actions 部署我的网站]]></title>
        <id>https://wjftu.com/blog/gh-deploy</id>
        <link href="https://wjftu.com/blog/gh-deploy"/>
        <updated>2021-12-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[使用 GitHub actions 自动部署我的网站]]></summary>
        <content type="html"><![CDATA[<p>使用 GitHub actions 自动部署我的网站</p>
<p>我的网站由 Vuepress 和 Docsisy 搭建，根目录是 Docsify ，每个笔记是 Vuepress 。为了编译，自己做了个 GitHub action 来编译多个 Vuepress 项目 ：<a href="https://github.com/wjftu/vuepress_1.x_compiler" target="_blank" rel="noopener noreferrer">https://github.com/wjftu/vuepress_1.x_compiler</a></p>
<p>Dockerfile</p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM node:14-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL "com.github.actions.name"="vuepress1.x_compiler"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LABEL "author"="Jianfeng"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt update &amp;&amp; yarn global add vuepress &amp;&amp; yarn global add @vuepress/plugin-google-analytics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY entrypoint.sh /entrypoint.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["/entrypoint.sh"]</span><br></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set -e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo ''</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "node version: $(node -v)"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "npm version: $(npm -v)"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ -z "$SOURCE_DIR" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  source="/"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  source="$SOURCE_DIR"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [[ -z "$BUILD_SCRIPT" ]]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script="yarn &amp;&amp; yarn docs:build"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script="$BUILD_SCRIPT"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Build vuepress project</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "BUILD_SCRIPT: ${script}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "github.workspace: ${GITHUB_WORKSPACE}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dir="${GITHUB_WORKSPACE}/"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "npm view: `npm view vuepress`"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in ${source}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo `ls`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cd ${dir}${i}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo "start build in : `pwd`"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  eval "${script}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  echo "${i} Build success"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "Build Success!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">© 2022 GitHub, Inc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Terms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Privacy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>虽然 Github actions market place 有现成的，但是没有多项目的，所以自己写了一个。其实不太懂 node.js ，感觉这样写可能不对，我怀疑 setup-node 之后直接编译就可以，不过这个 action 可以用。</p>
<p>.github/workflows/deploy.yml 文件中使用这个 action</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy_to_gh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">push</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">build-and-deploy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Checkout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Copy Files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        mkdir public </span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        cp -r home/. public/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wjftu/vuepress_1.x_compiler@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">SOURCE_DIR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> designPattern algorithmPractice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wjftu/git_push_action@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ACCESS_TOKEN</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets.ACCESS_TOKEN </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">TARGET_REPO</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> wjftu/wjftu.github.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">TARGET_BRANCH</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">SOURCE_DIR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> public</span><br></span></code></pre></div></div>
<p>每次 push 即可自动编译和部署。</p>
<p>后来不用 Docsify 和 Vuepress 了，改为 Docusaurus ，不知道为什么官方文档介绍的 setup-node 的 Github actions 的编译方法不能用，然后继续用这个 action</p>]]></content>
        <category label="github" term="github"/>
        <category label="CICD" term="CICD"/>
        <category label="github actions" term="github actions"/>
    </entry>
</feed>